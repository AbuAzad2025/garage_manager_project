{% extends 'base.html' %}
{% block title %}๐ ุงูุชุฏุฑูุจุงุช ุงููุชุฎุตุตุฉ - ุฏููุงููููุฉ{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      
      <div class="card bg-gradient-primary text-white mb-4">
        <div class="card-body">
          <h2><i class="fas fa-graduation-cap"></i> ูุฑูุฒ ุงูุชุฏุฑูุจุงุช ุงููุชุฎุตุตุฉ</h2>
          <p class="mb-0">ุงุฎุชุฑ ุงูุจุงูุงุช ุงูุชุฏุฑูุจูุฉ ุงูุชู ุชุฑูุฏูุง - ุชุฏุฑูุจ ุญูููู ูููููุณ</p>
        </div>
      </div>
      
      <div class="row">
        
        <div class="col-md-4 mb-4">
          <div class="card border-success shadow h-100">
            <div class="card-header bg-success text-white">
              <h5><i class="fas fa-comments"></i> ุงูุชุฑุญูุจ ูุงูุฏุฑุฏุดุฉ</h5>
              <span class="badge bg-light text-dark">150 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>ุงูุชุฑุญูุจ ุจุงููุณุชุฎุฏููู</li>
                <li>ุงูุฏุฑุฏุดุฉ ุงูุนุงุฏูุฉ ุงููุญุชุฑูุฉ</li>
                <li>ุงุณุชุฎุฏุงู ุนุจุงุฑุงุช ููุฐุจุฉ</li>
                <li>ุจุฏุก ุงููุญุงุฏุซุงุช</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-success" onclick="trainPackage('greeting_conversation')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-md-4 mb-4">
          <div class="card border-info shadow h-100">
            <div class="card-header bg-info text-white">
              <h5><i class="fas fa-building"></i> ุดุฑูุฉ ุฃุฒุงุฏ</h5>
              <span class="badge bg-light text-dark">80 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>ุงูุชุนุฑูู ุจุงูุดุฑูุฉ</li>
                <li>ูููุฒุงุช ุงููุธุงู</li>
                <li>ุงููุญุฏุงุช ุงููุชููุฑุฉ</li>
                <li>ุงูุฑูุงุฏุฉ ูุงูุชุทูุฑ</li>
                <li>ุทูุจ ุงูุฏุนู ูุงูุชุดุฌูุน</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-info" onclick="trainPackage('azad_company')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-md-4 mb-4">
          <div class="card border-warning shadow h-100">
            <div class="card-header bg-warning text-dark">
              <h5><i class="fas fa-smile"></i> ูููู ุงูุฑุฏ ูุงููุทุงูุฉ</h5>
              <span class="badge bg-dark">120 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>ูุจุงุฏุฆ ุงูุชูุงุตู ุงููุนุงู</li>
                <li>ุงูุฑุฏ ุงููุทูู ูุงูููุฐุจ</li>
                <li>ุฃููุงุท ุงูุฑุฏูุฏ ุงููุฎุชููุฉ</li>
                <li>ุงูุชุนุงูู ูุน ุงูููุงูู</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-warning" onclick="trainPackage('communication_skills')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-md-4 mb-4">
          <div class="card border-danger shadow h-100">
            <div class="card-header bg-danger text-white">
              <h5><i class="fas fa-shield-alt"></i> ุงูุฃุฎูุงู ูุงูุงุญุชุฑุงููุฉ</h5>
              <span class="badge bg-light text-dark">60 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>ุงูุจุนุฏ ุนู ุงูููุงุถูุน ุบูุฑ ุงููุงุฆูุฉ</li>
                <li>ุงูุฑุฏ ุงูููุฐุจ ุฏุงุฆูุงู</li>
                <li>ุงูุญุฏูุฏ ุงูููููุฉ</li>
                <li>ุงููุจุงุฏุฆ ุงูุฃุฎูุงููุฉ</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-danger" onclick="trainPackage('ethics_professionalism')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-md-4 mb-4">
          <div class="card border-primary shadow h-100">
            <div class="card-header bg-primary text-white">
              <h5><i class="fas fa-calculator"></i> ุจุฑูููุณูุฑ ูุญุงุณุจุฉ</h5>
              <span class="badge bg-light text-dark">300 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>20+ ููููู ูุญุงุณุจู</li>
                <li>ุงููุนุงุฏูุงุช ุงููุญุงุณุจูุฉ</li>
                <li>ุงููููุฏ ุงููุญุงุณุจูุฉ</li>
                <li>ุงูููุงุฆู ุงููุงููุฉ</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-primary" onclick="trainPackage('accounting_professor')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-md-4 mb-4">
          <div class="card border-secondary shadow h-100">
            <div class="card-header bg-secondary text-white">
              <h5><i class="fas fa-chart-line"></i> ุงูุฅุฏุงุฑุฉ ูุงููุงููุฉ</h5>
              <span class="badge bg-light text-dark">250 ุนูุตุฑ</span>
            </div>
            <div class="card-body">
              <p>ุชุฏุฑูุจ ุนูู:</p>
              <ul class="small">
                <li>ููุงููู ุงูุฅุฏุงุฑุฉ</li>
                <li>ุงููุณุจ ุงููุงููุฉ</li>
                <li>ุงููุฑุงุฑุงุช ุงูุชุฌุงุฑูุฉ</li>
                <li>ุงูุชุญููู ุงููุงูู</li>
              </ul>
              <div class="d-grid">
                <button class="btn btn-secondary" onclick="trainPackage('management_finance')">
                  <i class="fas fa-play"></i> ุจุฏุก ุงูุชุฏุฑูุจ
                </button>
              </div>
            </div>
          </div>
        </div>
        
      </div>
      
      <div class="row mt-4">
        <div class="col-12">
          <div class="card bg-dark text-white">
            <div class="card-body text-center">
              <h4><i class="fas fa-rocket"></i> ุชุฏุฑูุจ ุดุงูู - ูู ุงูุจุงูุงุช</h4>
              <p class="mb-3">ุชุฏุฑูุจ ุนูู ุฌููุน ุงูุชุฎุตุตุงุช ูุฑุฉ ูุงุญุฏุฉ (960+ ุนูุตุฑ)</p>
              <button class="btn btn-light btn-lg" onclick="trainAllPackages()">
                <i class="fas fa-fire"></i> ุชุฏุฑูุจ ููุซู ุดุงูู
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-info text-white">
              <h5><i class="fas fa-tasks"></i> ุญุงูุฉ ุงูุชุฏุฑูุจ</h5>
            </div>
            <div class="card-body">
              <div id="training-status"></div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>

<script>
let statusCheckInterval = null;

async function trainPackage(packageId) {
  const statusDiv = document.getElementById('training-status');
  statusDiv.innerHTML = '<div class="alert alert-info"><i class="fas fa-spinner fa-spin"></i> ุฌุงุฑู ุงูุชุฏุฑูุจ...</div>';
  
  try {
    const response = await fetch('/ai/admin/train-package', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({package_id: packageId})
    });
    
    const data = await response.json();
    
    if (data.success) {
      statusDiv.innerHTML = `
        <div class="alert alert-success">
          <h5>ุชู ุงูุชุฏุฑูุจ ุจูุฌุงุญ!</h5>
          <p><strong>ุงูุจุงูุฉ:</strong> ${data.package_name || packageId}</p>
          <p><strong>ุงูุนูุงุตุฑ ุงููุชุนููุฉ:</strong> ${data.items_learned}</p>
          <p class="mb-0"><i class="fas fa-check-circle"></i> ุชู ุญูุธ ุงููุนุฑูุฉ ูู ุงูุฐุงูุฑุฉ</p>
        </div>
      `;
      
      Swal.fire({
        icon: 'success',
        title: 'ุชู ุงูุชุฏุฑูุจ!',
        text: `ุชู ุชุนูู ${data.items_learned} ุนูุตุฑ ุจูุฌุงุญ`,
        confirmButtonText: 'ุฑุงุฆุน!'
      });
    } else {
      statusDiv.innerHTML = `<div class="alert alert-danger">ุฎุทุฃ: ${data.error}</div>`;
    }
  } catch (error) {
    statusDiv.innerHTML = `<div class="alert alert-danger">ุฎุทุฃ: ${error}</div>`;
  }
}

async function trainAllPackages() {
  const statusDiv = document.getElementById('training-status');
  
  Swal.fire({
    title: 'ุชุฏุฑูุจ ุดุงูู',
    text: 'ุณูุชู ุชุฏุฑูุจ ุงููุณุงุนุฏ ุนูู ุฌููุน ุงูุชุฎุตุตุงุช. ูุฏ ูุณุชุบุฑู ุฏูููุฉ...',
    icon: 'info',
    showCancelButton: true,
    confirmButtonText: 'ุงุจุฏุฃ',
    cancelButtonText: 'ุฅูุบุงุก'
  }).then(async (result) => {
    if (result.isConfirmed) {
      statusDiv.innerHTML = '<div class="alert alert-info"><i class="fas fa-spinner fa-spin"></i> ุฌุงุฑู ุงูุชุฏุฑูุจ ุงูุดุงูู...</div>';
      
      try {
        const response = await fetch('/ai/admin/train-all-packages', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'}
        });
        
        const data = await response.json();
        
        if (data.success) {
          let html = '<div class="alert alert-success">';
          html += '<h5>ุชู ุงูุชุฏุฑูุจ ุงูุดุงูู ุจูุฌุงุญ!</h5>';
          html += `<p><strong>ุงูุจุงูุงุช ุงููุฏุฑุจุฉ:</strong> ${data.packages_trained}</p>`;
          html += `<p><strong>ุฅุฌูุงูู ุงูุนูุงุตุฑ:</strong> ${data.total_items_learned}</p>`;
          html += '<hr><h6>ุงูุชูุงุตูู:</h6><ul>';
          
          for (const [pkg, result] of Object.entries(data.details)) {
            if (result.success) {
              html += `<li>${pkg}: ${result.items_learned} ุนูุตุฑ</li>`;
            }
          }
          
          html += '</ul></div>';
          statusDiv.innerHTML = html;
          
          Swal.fire({
            icon: 'success',
            title: 'ุชู ุงูุชุฏุฑูุจ ุงูุดุงูู!',
            html: `<p>ุชู ุชุฏุฑูุจ ${data.packages_trained} ุจุงูุฉ</p><p>ุฅุฌูุงูู: ${data.total_items_learned} ุนูุตุฑ</p>`,
            confirmButtonText: 'ููุชุงุฒ!'
          });
        } else {
          statusDiv.innerHTML = `<div class="alert alert-danger">ุฎุทุฃ: ${data.error}</div>`;
        }
      } catch (error) {
        statusDiv.innerHTML = `<div class="alert alert-danger">ุฎุทุฃ: ${error}</div>`;
      }
    }
  });
}
</script>

{% endblock %}

