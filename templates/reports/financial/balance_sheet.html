{% extends 'base.html' %}

{% block title %}Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-gradient-primary text-white">
            <h3 class="mb-0">
                <i class="fas fa-balance-scale"></i>
                Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ© (Balance Sheet)
            </h3>
            <p class="mb-0 small">ÙƒÙ…Ø§ ÙÙŠ {{ as_of_date.strftime('%Y-%m-%d') }}</p>
        </div>
        
        <div class="card-body">
            <!-- ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <label>ÙƒÙ…Ø§ ÙÙŠ ØªØ§Ø±ÙŠØ®:</label>
                    <input type="date" id="as_of_date" class="form-control" value="{{ as_of_date.strftime('%Y-%m-%d') }}">
                </div>
                <div class="col-md-6">
                    <label>&nbsp;</label>
                    <button class="btn btn-primary d-block w-100" onclick="updateReport()">
                        <i class="fas fa-sync"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <!-- Ø§Ù„Ø£ØµÙˆÙ„ -->
                    <table class="table table-bordered">
                        <thead class="table-primary">
                            <tr>
                                <th colspan="2"><h5 class="mb-0">ğŸ’° Ø§Ù„Ø£ØµÙˆÙ„</h5></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for asset in assets %}
                            <tr>
                                <td>{{ asset.name }} <small class="text-muted">({{ asset.account }})</small></td>
                                <td class="text-end fw-bold">{{ "{:,.2f}".format(asset.balance) }} â‚ª</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot class="table-primary fw-bold fs-5">
                            <tr>
                                <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</td>
                                <td class="text-end">{{ "{:,.2f}".format(total_assets) }} â‚ª</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                
                <div class="col-md-6">
                    <!-- Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© -->
                    <table class="table table-bordered">
                        <thead class="table-danger">
                            <tr>
                                <th colspan="2"><h5 class="mb-0">ğŸ“Š Ø§Ù„Ø®ØµÙˆÙ…</h5></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for liability in liabilities %}
                            <tr>
                                <td>{{ liability.name }} <small class="text-muted">({{ liability.account }})</small></td>
                                <td class="text-end fw-bold">{{ "{:,.2f}".format(liability.balance) }} â‚ª</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot class="table-danger fw-bold">
                            <tr>
                                <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…</td>
                                <td class="text-end">{{ "{:,.2f}".format(total_liabilities) }} â‚ª</td>
                            </tr>
                        </tfoot>
                        
                        <thead class="table-secondary mt-3">
                            <tr>
                                <th colspan="2"><h5 class="mb-0">ğŸ¦ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h5></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for eq in equity %}
                            <tr>
                                <td>{{ eq.name }} <small class="text-muted">({{ eq.account }})</small></td>
                                <td class="text-end fw-bold">{{ "{:,.2f}".format(eq.balance) }} â‚ª</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ù„Ù„ÙØªØ±Ø©</td>
                                <td class="text-end fw-bold {% if net_income >= 0 %}text-success{% else %}text-danger{% endif %}">
                                    {{ "{:,.2f}".format(net_income) }} â‚ª
                                </td>
                            </tr>
                        </tbody>
                        <tfoot class="table-secondary fw-bold">
                            <tr>
                                <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</td>
                                <td class="text-end">{{ "{:,.2f}".format(total_equity) }} â‚ª</td>
                            </tr>
                        </tfoot>
                        
                        <tfoot class="table-dark fw-bold fs-5">
                            <tr>
                                <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ… + Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</td>
                                <td class="text-end">{{ "{:,.2f}".format(total_liabilities + total_equity) }} â‚ª</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            
            <!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆØ§Ø²Ù† -->
            <div class="alert {% if is_balanced %}alert-success{% else %}alert-danger{% endif %} mt-4">
                <h5>
                    {% if is_balanced %}
                    âœ… Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù…ØªÙˆØ§Ø²Ù†Ø©!
                    {% else %}
                    âŒ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ØºÙŠØ± Ù…ØªÙˆØ§Ø²Ù†Ø©!
                    {% endif %}
                </h5>
                <p class="mb-0">
                    <strong>Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©:</strong>
                    Ø§Ù„Ø£ØµÙˆÙ„ ({{ "{:,.2f}".format(total_assets) }})
                    =
                    Ø§Ù„Ø®ØµÙˆÙ… ({{ "{:,.2f}".format(total_liabilities) }})
                    +
                    Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© ({{ "{:,.2f}".format(total_equity) }})
                </p>
            </div>
            
            <!-- Ø£Ø²Ø±Ø§Ø± -->
            <div class="row mt-3">
                <div class="col-md-6">
                    <button class="btn btn-success w-100" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i> ØªØµØ¯ÙŠØ± Excel
                    </button>
                </div>
                <div class="col-md-6">
                    <button class="btn btn-info w-100" onclick="window.print()">
                        <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.bg-gradient-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
</style>

<script>
function updateReport() {
    const asOfDate = document.getElementById('as_of_date').value;
    window.location.href = `/financial-reports/balance-sheet?as_of_date=${asOfDate}`;
}

function exportToExcel() {
    alert('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØµØ¯ÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹');
}
</script>
{% endblock %}

