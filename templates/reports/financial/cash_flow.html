{% extends 'base.html' %}

{% block title %}ูุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-gradient-primary text-white">
            <h3 class="mb-0">
                <i class="fas fa-money-bill-wave"></i>
                ูุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ (Cash Flow Statement)
            </h3>
            <p class="mb-0 small">ูู {{ from_date.strftime('%Y-%m-%d') }} ุฅูู {{ to_date.strftime('%Y-%m-%d') }}</p>
        </div>
        
        <div class="card-body">
            <!-- ููุชุฑ ุงูุชูุงุฑูุฎ -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <label>ูู ุชุงุฑูุฎ:</label>
                    <input type="date" id="from_date" class="form-control" value="{{ from_date.strftime('%Y-%m-%d') }}">
                </div>
                <div class="col-md-4">
                    <label>ุฅูู ุชุงุฑูุฎ:</label>
                    <input type="date" id="to_date" class="form-control" value="{{ to_date.strftime('%Y-%m-%d') }}">
                </div>
                <div class="col-md-4">
                    <label>&nbsp;</label>
                    <button class="btn btn-primary d-block w-100" onclick="updateReport()">
                        <i class="fas fa-sync"></i> ุชุญุฏูุซ
                    </button>
                </div>
            </div>
            
            <table class="table table-bordered">
                <!-- ุงูุชุฏููุงุช ุงูุชุดุบูููุฉ -->
                <thead class="table-success">
                    <tr>
                        <th colspan="2"><h5 class="mb-0">๐ผ ุงูุชุฏููุงุช ุงูุชุดุบูููุฉ</h5></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ูุงุฑุฏุฉ (ูู ุงูุนููุงุก)</td>
                        <td class="text-end text-success fw-bold">+{{ "{:,.2f}".format(operating.inflows) }} โช</td>
                    </tr>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ุตุงุฏุฑุฉ (ููููุฑุฏูู ูุงููุตุงุฑูู)</td>
                        <td class="text-end text-danger fw-bold">-{{ "{:,.2f}".format(operating.outflows) }} โช</td>
                    </tr>
                </tbody>
                <tfoot class="table-success fw-bold">
                    <tr>
                        <td>ุตุงูู ุงูุชุฏููุงุช ุงูุชุดุบูููุฉ</td>
                        <td class="text-end {% if operating.net >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {{ "{:,.2f}".format(operating.net) }} โช
                        </td>
                    </tr>
                </tfoot>
                
                <!-- ุงูุชุฏููุงุช ุงูุงุณุชุซูุงุฑูุฉ -->
                <thead class="table-info mt-3">
                    <tr>
                        <th colspan="2"><h5 class="mb-0">๐ญ ุงูุชุฏููุงุช ุงูุงุณุชุซูุงุฑูุฉ</h5></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ูุงุฑุฏุฉ (ุจูุน ุฃุตูู)</td>
                        <td class="text-end text-success fw-bold">+{{ "{:,.2f}".format(investing.inflows) }} โช</td>
                    </tr>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ุตุงุฏุฑุฉ (ุดุฑุงุก ุฃุตูู/ูุนุฏุงุช)</td>
                        <td class="text-end text-danger fw-bold">-{{ "{:,.2f}".format(investing.outflows) }} โช</td>
                    </tr>
                </tbody>
                <tfoot class="table-info fw-bold">
                    <tr>
                        <td>ุตุงูู ุงูุชุฏููุงุช ุงูุงุณุชุซูุงุฑูุฉ</td>
                        <td class="text-end {% if investing.net >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {{ "{:,.2f}".format(investing.net) }} โช
                        </td>
                    </tr>
                </tfoot>
                
                <!-- ุงูุชุฏููุงุช ุงูุชูููููุฉ -->
                <thead class="table-warning mt-3">
                    <tr>
                        <th colspan="2"><h5 class="mb-0">๐ฆ ุงูุชุฏููุงุช ุงูุชูููููุฉ</h5></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ูุงุฑุฏุฉ (ูุฑูุถ/ุงุณุชุซูุงุฑุงุช)</td>
                        <td class="text-end text-success fw-bold">+{{ "{:,.2f}".format(financing.inflows) }} โช</td>
                    </tr>
                    <tr>
                        <td>ุชุฏููุงุช ููุฏูุฉ ุตุงุฏุฑุฉ (ุณุฏุงุฏ ูุฑูุถ/ุชูุฒูุนุงุช)</td>
                        <td class="text-end text-danger fw-bold">-{{ "{:,.2f}".format(financing.outflows) }} โช</td>
                    </tr>
                </tbody>
                <tfoot class="table-warning fw-bold">
                    <tr>
                        <td>ุตุงูู ุงูุชุฏููุงุช ุงูุชูููููุฉ</td>
                        <td class="text-end {% if financing.net >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {{ "{:,.2f}".format(financing.net) }} โช
                        </td>
                    </tr>
                </tfoot>
                
                <!-- ุตุงูู ุงูุชุบูุฑ ูู ุงูููุฏูุฉ -->
                <tfoot class="table-dark fw-bold fs-5">
                    <tr>
                        <td>ุตุงูู ุงูุชุบูุฑ ูู ุงูููุฏูุฉ</td>
                        <td class="text-end {% if total_net_cash_flow >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {{ "{:,.2f}".format(total_net_cash_flow) }} โช
                        </td>
                    </tr>
                </tfoot>
            </table>
            
            <!-- ุฃุฒุฑุงุฑ -->
            <div class="row mt-3">
                <div class="col-md-6">
                    <button class="btn btn-success w-100" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i> ุชุตุฏูุฑ Excel
                    </button>
                </div>
                <div class="col-md-6">
                    <button class="btn btn-info w-100" onclick="window.print()">
                        <i class="fas fa-print"></i> ุทุจุงุนุฉ
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.bg-gradient-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
</style>

<script>
function updateReport() {
    const fromDate = document.getElementById('from_date').value;
    const toDate = document.getElementById('to_date').value;
    window.location.href = `/financial-reports/cash-flow?from_date=${fromDate}&to_date=${toDate}`;
}

function exportToExcel() {
    alert('ุณูุชู ุฅุถุงูุฉ ูุธููุฉ ุงูุชุตุฏูุฑ ูุฑูุจุงู');
}
</script>
{% endblock %}

