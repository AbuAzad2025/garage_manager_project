{% extends 'base.html' %}
{% block title %}كشف الأنماط{% endblock %}
{% block page_title %}🔍 كشف الأنماط المشبوهة{% endblock %}

{% block content %}
<div class="container-fluid">
  
  {% include 'security/_navigation.html' %}
  
  <div class="card">
    <div class="card-header bg-danger text-white">
      <h5 class="mb-0">أنماط مشبوهة تم اكتشافها</h5>
    </div>
    <div class="card-body">
      {% if patterns %}
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th>النوع</th>
                <th>التفاصيل</th>
                <th>الخطورة</th>
                <th>إجراء</th>
              </tr>
            </thead>
            <tbody>
              {% for pattern in patterns %}
              <tr>
                <td>{{ pattern.type }}</td>
                <td>
                  {% if pattern.ip %}<code>{{ pattern.ip }}</code>{% endif %}
                  {% if pattern.count %} - {{ pattern.count }} محاولة{% endif %}
                </td>
                <td>
                  <span class="badge bg-{{ pattern.severity == 'high' and 'danger' or 'warning' }}">
                    {{ pattern.severity }}
                  </span>
                </td>
                <td>
                  {% if pattern.ip %}
                  <a href="{{ url_for('security.block_ip') }}?ip={{ pattern.ip }}" class="btn btn-sm btn-danger">حظر</a>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-success text-center py-4">
          <i class="fas fa-check-circle fa-3x mb-3"></i><br>
          لا توجد أنماط مشبوهة. النظام آمن! ✅
        </p>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}

