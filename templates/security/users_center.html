{% extends 'base.html' %}
{% block title %}مركز المستخدمين والصلاحيات{% endblock %}
{% block page_title %}👥 مركز المستخدمين والصلاحيات{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active"><i class="fas fa-users-cog"></i> Users Center</li>
{% if active_tab %}
<li class="breadcrumb-item active">{{ active_tab|title }}</li>
{% endif %}
{% endblock %}

{% block content %}
<div class="container-fluid">
  
  {% include 'security/_navigation.html' %}
  
  <div class="alert border-0 shadow-sm" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <i class="fas fa-users-cog"></i>
        <strong>Users & Permissions Center:</strong>
        <span class="badge bg-white text-primary ms-2">2 أدوات في مكان واحد</span>
      </div>
      <small class="opacity-75">مستخدمين + صلاحيات</small>
    </div>
  </div>

  <div class="card shadow">
    <div class="card-header text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      <h5 class="mb-0"><i class="fas fa-users-cog"></i> Users & Permissions Center</h5>
    </div>
    
    <div class="card-body p-0">
      
      <ul class="nav nav-tabs nav-fill" style="border-bottom: 2px solid #dee2e6;">
        <li class="nav-item">
          <a class="nav-link {% if active_tab == 'users' %}active{% endif %}" 
             href="{{ url_for('security.users_center', tab='users') }}">
            <i class="fas fa-users"></i> التحكم بالمستخدمين
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if active_tab == 'permissions' %}active{% endif %}" 
             href="{{ url_for('security.users_center', tab='permissions') }}">
            <i class="fas fa-key"></i> إدارة الصلاحيات
          </a>
        </li>
      </ul>

      <div class="tab-content p-4">
        
        {% if active_tab == 'users' %}
        <div class="container-fluid">
          <h4><i class="fas fa-users text-primary"></i> التحكم بالمستخدمين</h4>
          
          <div class="mb-3">
            <button class="btn btn-success me-2" onclick="importUsersFromExcel()">
              <i class="fas fa-file-excel"></i> استيراد من Excel
            </button>
            <button class="btn btn-outline-success me-2" onclick="exportUsersToExcel()">
              <i class="fas fa-download"></i> تصدير إلى Excel
            </button>
          </div>
          
          <a href="{{ url_for('security.user_control') }}" class="btn btn-primary btn-lg" target="_blank">
            <i class="fas fa-external-link-alt"></i> فتح لوحة التحكم (مع Bulk Operations)
          </a>
        </div>
        {% endif %}
        
        {% if active_tab == 'permissions' %}
        <div class="container-fluid">
          <h4><i class="fas fa-key text-success"></i> إدارة الصلاحيات</h4>
          
          <div class="mb-3">
            <button class="btn btn-info me-2" onclick="showPermissionMatrix()">
              <i class="fas fa-table"></i> عرض مصفوفة الصلاحيات
            </button>
          </div>
          
          <a href="{{ url_for('security.permissions_manager') }}" class="btn btn-success btn-lg" target="_blank">
            <i class="fas fa-external-link-alt"></i> فتح الصلاحيات
          </a>
        </div>
        {% endif %}
        
      </div>
    </div>
  </div>
</div>
{% endblock %}

