{% extends 'base.html' %}
{% block title %}ูุญุฏุฉ ุงูุฃูุงู ุงููุชูุฏูุฉ{% endblock %}
{% block page_title %}๐ ูุญุฏุฉ ุงูุฃูุงู ุงููุชูุฏูุฉ{% endblock %}

{% block content %}
<div class="container-fluid">
  
  {% include 'security/_navigation.html' %}
  
  <div class="alert alert-danger border-0 shadow-sm">
    <i class="fas fa-exclamation-triangle"></i>
    <strong>ุชุญุฐูุฑ:</strong> ูุฐู ุงููุญุฏุฉ ุณุฑูุฉ ููุชุงุญุฉ ููุท ูู Super Admin. ุฌููุน ุงูุฅุฌุฑุงุกุงุช ูุชู ุชุณุฌูููุง.
  </div>

  <div class="alert alert-info border-0 shadow-sm">
    <i class="fas fa-info-circle"></i>
    <strong>ุชูุธูู ุงูุตูุญุงุช:</strong>
    <ul class="mb-0 mt-2">
      <li><strong>ูุฐู ุงูุตูุญุฉ:</strong> ุงูุฃูุงู ุงูุฃุณุงุณู + ุงูุฅุญุตุงุฆูุงุช + ุงูุญุธุฑ</li>
      <li><strong>ููุญุฉ ุงูุชุญูู ุงูููุงุฆูุฉ:</strong> ุฃุฏูุงุช ูุชูุฏูุฉ + AI + ุชุทููุฑ + ุฅุนุฏุงุฏุงุช</li>
    </ul>
  </div>

  <!-- ุงูุฅุญุตุงุฆูุงุช -->
  <div class="row g-3 mb-4">
    <div class="col-lg-3 col-md-6">
      <div class="small-box bg-info">
        <div class="inner">
          <h3>{{ stats.total_users }}</h3>
          <p>ุฅุฌูุงูู ุงููุณุชุฎุฏููู</p>
        </div>
        <div class="icon"><i class="fas fa-users"></i></div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="small-box bg-success">
        <div class="inner">
          <h3>{{ stats.active_users }}</h3>
          <p>ูุณุชุฎุฏููู ูุดุทูู</p>
        </div>
        <div class="icon"><i class="fas fa-user-check"></i></div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="small-box bg-danger">
        <div class="inner">
          <h3>{{ stats.blocked_users }}</h3>
          <p>ูุณุชุฎุฏููู ูุญุธูุฑูู</p>
        </div>
        <div class="icon"><i class="fas fa-user-lock"></i></div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="small-box bg-warning">
        <div class="inner">
          <h3>{{ stats.failed_logins_24h }}</h3>
          <p>ูุญุงููุงุช ูุงุดูุฉ (24 ุณุงุนุฉ)</p>
        </div>
        <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
      </div>
    </div>
  </div>

  <!-- ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ -->
  <div class="row g-3 mb-4">
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-crown fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark">
              {{ stats.total_users + 37 }}
            </span>
          </div>
          <h5 class="fw-bold">ููุญุฉ ุงูุชุญูู ุงูููุงุฆูุฉ</h5>
          <p class="small opacity-75">ุตูุงุญูุงุช ุฎุงุฑูุฉ + 37 ุฃุฏุงุฉ ูุชูุฏูุฉ</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.ultimate_control') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-bolt"></i> ุงูุชุญูู ุงูููุงุฆู
            </a>
            <small class="opacity-75">AI + ุฃุฏูุงุช + ุฅุนุฏุงุฏุงุช</small>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-robot fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success">
              AI
            </span>
          </div>
          <h5 class="fw-bold">AI & Analytics</h5>
          <p class="small opacity-75">ุฐูุงุก ุงุตุทูุงุนู + ุชุญููู ูุชูุฏู</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.ultimate_control') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-brain"></i> ุงูุฐูุงุจ ููุชุญูู ุงููุชูุฏู
            </a>
            <div class="row text-center">
              <div class="col-4">
                <small class="opacity-75">ูุณุงุนุฏ</small>
              </div>
              <div class="col-4">
                <small class="opacity-75">ุชุญููู</small>
              </div>
              <div class="col-4">
                <small class="opacity-75">ุชุฏุฑูุจ</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-code fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-info">
              API
            </span>
          </div>
          <h5 class="fw-bold">API Documentation</h5>
          <p class="small opacity-75">ูุซุงุฆู API ุงููุงููุฉ + ุฃูุซูุฉ</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('api.docs') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-book"></i> ุนุฑุถ ุงููุซุงุฆู
            </a>
            <div class="row text-center">
              <div class="col-6">
                <small class="opacity-75">Endpoints</small>
              </div>
              <div class="col-6">
                <small class="opacity-75">Examples</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #FF512F 0%, #DD2476 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-ban fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark">
              {{ stats.blocked_ips }}
            </span>
          </div>
          <h5 class="fw-bold">Firewall Manager</h5>
          <p class="small opacity-75">ุญุธุฑ IP + ุญูุงูุฉ ูุชูุฏูุฉ</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.block_ip') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-shield-alt"></i> ุฅุฏุงุฑุฉ ุงูุญุธุฑ
            </a>
            <div class="row text-center">
              <div class="col-6">
                <small class="opacity-75">ุญุธุฑ IP</small>
              </div>
              <div class="col-6">
                <small class="opacity-75">ุญุธุฑ ุฏููุฉ</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #f12711 0%, #f5af19 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-globe fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              {{ stats.blocked_countries }}
            </span>
          </div>
          <h5 class="fw-bold">ุญุธุฑ ุงูุฏูู</h5>
          <p class="small opacity-75">ุญุธุฑ ุฏูู ูุงููุฉ + ุฌุบุฑุงูู</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.block_country') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-flag"></i> ุฅุฏุงุฑุฉ ุงูุญุธุฑ
            </a>
            <div class="row text-center">
              <div class="col-6">
                <small class="opacity-75">ุญุธุฑ ุฏููุฉ</small>
              </div>
              <div class="col-6">
                <small class="opacity-75">ุฅูุบุงุก ุญุธุฑ</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #134E5E 0%, #71B280 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-broom fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark">
              โ๏ธ
            </span>
          </div>
          <h5 class="fw-bold">ุชูุธูู ุงููุธุงู</h5>
          <p class="small opacity-75">ุญุฐู ุจูุงูุงุช + ุชุญุณูู ุงูุฃุฏุงุก</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.system_cleanup') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-trash-alt"></i> ุชูุธูู ุขูู
            </a>
            <div class="row text-center">
              <div class="col-6">
                <small class="opacity-75">ุญุฐู ุจูุงูุงุช</small>
              </div>
              <div class="col-6">
                <small class="opacity-75">ุชุญุณูู</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-file-alt fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success">
              6
            </span>
          </div>
          <h5 class="fw-bold">ุงูููุฌุงุช ูุงูุณุฌูุงุช</h5>
          <p class="small opacity-75">6 ุฃููุงุน ููุฌุงุช ุดุงููุฉ</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.logs_viewer') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-eye"></i> ุนุฑุถ ุงูููุฌุงุช
            </a>
            <div class="row text-center">
              <div class="col-4">
                <small class="opacity-75">ุฃุฎุทุงุก</small>
              </div>
              <div class="col-4">
                <small class="opacity-75">ุฃูุงู</small>
              </div>
              <div class="col-4">
                <small class="opacity-75">ุฃุฏุงุก</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-3 col-md-6">
      <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
        <div class="card-body text-center text-white">
          <div class="position-relative">
            <i class="fas fa-cogs fa-3x mb-3" style="text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark">
              โ๏ธ
            </span>
          </div>
          <h5 class="fw-bold">ุฅุนุฏุงุฏุงุช ุงููุธุงู</h5>
          <p class="small opacity-75">ุชูููู + ุฅุนุฏุงุฏุงุช ูุชูุฏูุฉ</p>
          <div class="d-grid gap-2">
            <a href="{{ url_for('security.ultimate_control') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-sliders-h"></i> ุงูุฐูุงุจ ููุฅุนุฏุงุฏุงุช
            </a>
            <div class="row text-center">
              <div class="col-6">
                <small class="opacity-75">ุชูููู</small>
              </div>
              <div class="col-6">
                <small class="opacity-75">ูุชูุฏู</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ุงููุญุธูุฑูู -->
  <div class="row g-3">
    <div class="col-lg-6">
      <div class="card border-0 shadow-lg" style="background: linear-gradient(135deg, #FF512F 0%, #DD2476 100%);">
        <div class="card-header text-white border-0" style="background: rgba(255,255,255,0.1);">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0 fw-bold"><i class="fas fa-ban"></i> IPs ูุญุธูุฑุฉ</h5>
            <span class="badge bg-warning text-dark fs-6">{{ stats.blocked_ips }}</span>
          </div>
        </div>
        <div class="card-body text-white">
          <div class="row text-center">
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.blocked_ips }}</h4>
              <small class="opacity-75">IPs ูุญุธูุฑุฉ</small>
            </div>
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.failed_logins_24h }}</h4>
              <small class="opacity-75">ูุญุงููุงุช ูุงุดูุฉ</small>
            </div>
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.suspicious_activities }}</h4>
              <small class="opacity-75">ุฃูุดุทุฉ ูุดุจููุฉ</small>
            </div>
          </div>
          <div class="d-grid gap-2 mt-3">
            <a href="{{ url_for('security.blocked_ips') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-list"></i> ุนุฑุถ ุงููุงุฆูุฉ ุงููุงููุฉ
            </a>
            <a href="{{ url_for('security.block_ip') }}" class="btn btn-outline-light btn-sm">
              <i class="fas fa-plus"></i> ุญุธุฑ IP ุฌุฏูุฏ
            </a>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-6">
      <div class="card border-0 shadow-lg" style="background: linear-gradient(135deg, #f12711 0%, #f5af19 100%);">
        <div class="card-header text-white border-0" style="background: rgba(255,255,255,0.1);">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0 fw-bold"><i class="fas fa-globe"></i> ุฏูู ูุญุธูุฑุฉ</h5>
            <span class="badge bg-danger fs-6">{{ stats.blocked_countries }}</span>
          </div>
        </div>
        <div class="card-body text-white">
          <div class="row text-center">
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.blocked_countries }}</h4>
              <small class="opacity-75">ุฏูู ูุญุธูุฑุฉ</small>
            </div>
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.total_users }}</h4>
              <small class="opacity-75">ุฅุฌูุงูู ุงููุณุชุฎุฏููู</small>
            </div>
            <div class="col-4">
              <h4 class="fw-bold">{{ stats.active_users }}</h4>
              <small class="opacity-75">ูุณุชุฎุฏููู ูุดุทูู</small>
            </div>
          </div>
          <div class="d-grid gap-2 mt-3">
            <a href="{{ url_for('security.blocked_countries') }}" class="btn btn-light btn-sm fw-bold">
              <i class="fas fa-list"></i> ุนุฑุถ ุงููุงุฆูุฉ ุงููุงููุฉ
            </a>
            <a href="{{ url_for('security.block_country') }}" class="btn btn-outline-light btn-sm">
              <i class="fas fa-plus"></i> ุญุธุฑ ุฏููุฉ ุฌุฏูุฏุฉ
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

