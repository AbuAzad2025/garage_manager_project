{% extends 'security/base_security.html' %}
{% block tour_name %}system_branding{% endblock %}
{% block security_title %}System Branding{% endblock %}
{% block security_icon %}<i class="fas fa-paint-brush"></i>{% endblock %}
{% block security_description %}تخصيص الاسم والشعارات والألوان{% endblock %}
{% block security_breadcrumb %}<li class="breadcrumb-item active">System Branding</li>{% endblock %}
{% block security_content %}
  
  <div class="alert alert-info border-0 shadow-sm">
    <i class="fas fa-palette"></i>
    <strong>تخصيص شامل:</strong> اسم النظام، الشعارات، الألوان، والأيقونات - كل شيء في مكان واحد
  </div>

  <form method="POST" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="row g-4">
      
      <div class="col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-gradient-primary text-white">
            <h5 class="mb-0"><i class="fas fa-tag"></i> بيانات النظام</h5>
          </div>
          <div class="card-body">
            
            <div class="mb-3">
              <label class="form-label fw-bold">اسم النظام</label>
              <input type="text" 
                     name="system_name" 
                     class="form-control" 
                     value="{{ branding.system_name }}" 
                     placeholder="Garage Manager"
                     minlength="3"
                     required>
              <small class="text-muted">يظهر في الشريط العلوي والصفحات</small>
            </div>
            
            <div class="mb-3">
              <label class="form-label fw-bold">وصف النظام</label>
              <textarea name="system_description" 
                        class="form-control" 
                        rows="3" 
                        placeholder="نظام احترافي لإدارة الكراجات">{{ branding.system_description }}</textarea>
              <small class="text-muted">يظهر في صفحة تسجيل الدخول وصفحات التعريف</small>
            </div>
            
            <div class="mb-3">
              <label class="form-label fw-bold">اللون الأساسي (Primary Color)</label>
              <div class="input-group">
                <input type="color" 
                       name="primary_color" 
                       class="form-control form-control-color" 
                       value="{{ branding.primary_color }}" 
                       title="اختر اللون الأساسي">
                <input type="text" 
                       class="form-control" 
                       value="{{ branding.primary_color }}" 
                       id="colorHex" 
                       readonly>
              </div>
              <small class="text-muted">اللون الرئيسي للأزرار والعناوين</small>
            </div>
            
          </div>
        </div>
      </div>
      
      <div class="col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-gradient-success text-white">
            <h5 class="mb-0"><i class="fas fa-images"></i> الشعارات والأيقونات</h5>
          </div>
          <div class="card-body">
            
            <div class="mb-4">
              <label class="form-label fw-bold">الشعار الرئيسي</label>
              <div class="mb-2 p-3 bg-light rounded text-center">
                {% if branding.custom_logo %}
                <img src="/{{ branding.custom_logo }}?v={{ range(1000, 9999)|random }}" 
                     alt="Current Logo" 
                     style="max-height: 100px; max-width: 100%;">
                {% else %}
                <img src="{{ url_for('static', filename='img/azad_logo.png') }}" 
                     alt="Default Logo" 
                     style="max-height: 100px; max-width: 100%;">
                {% endif %}
              </div>
              <input type="file" 
                     name="logo" 
                     class="form-control" 
                     accept="image/png,image/jpeg,image/gif,image/webp">
              <small class="text-muted">PNG, JPG, GIF, WEBP - يفضل خلفية شفافة</small>
            </div>
            
            <div class="mb-3">
              <label class="form-label fw-bold">الأيقونة (Favicon)</label>
              <div class="mb-2 p-3 bg-light rounded text-center">
                {% if branding.custom_favicon %}
                <img src="/{{ branding.custom_favicon }}?v={{ range(1000, 9999)|random }}" 
                     alt="Current Favicon" 
                     style="height: 48px;">
                {% else %}
                <img src="{{ url_for('static', filename='img/azad_favicon.png') }}" 
                     alt="Default Favicon" 
                     style="height: 48px;">
                {% endif %}
              </div>
              <input type="file" 
                     name="favicon" 
                     class="form-control" 
                     accept="image/png,image/x-icon">
              <small class="text-muted">PNG أو ICO - مقاس 32x32 أو 48x48</small>
            </div>
            
          </div>
        </div>
      </div>
      
      <div class="col-lg-12">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-gradient-info text-white">
            <h5 class="mb-0"><i class="fas fa-eye"></i> معاينة التغييرات</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <h6>عينة القوائم:</h6>
                <button type="button" class="btn btn-primary mb-2 w-100" id="preview-btn-primary" onclick="alert('✅ الأزرار تعمل بشكل صحيح!')">
                  زر باللون الأساسي
                </button>
                <button type="button" class="btn btn-outline-primary mb-2 w-100" onclick="alert('✅ زر منقط يعمل!')">زر منقط</button>
              </div>
              <div class="col-md-6">
                <h6>عينة الشارات:</h6>
                <div>
                  <span class="badge bg-primary ml-1">Badge</span>
                  <span class="badge bg-success ml-1">نجاح</span>
                  <span class="badge bg-danger ml-1">خطر</span>
                  <span class="badge bg-warning text-dark ml-1">تحذير</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-12">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <button type="submit" class="btn btn-lg btn-success px-5">
              <i class="fas fa-save"></i> حفظ التغييرات
            </button>
            <a href="{{ url_for('security.index') }}" class="btn btn-lg btn-outline-secondary px-5 ms-2">
              <i class="fas fa-times"></i> إلغاء
            </a>
          </div>
        </div>
      </div>
      
    </div>
  </form>

</div>

<script>
document.querySelector('input[name="primary_color"]').addEventListener('input', function() {
  document.getElementById('colorHex').value = this.value;
  document.getElementById('preview-btn-primary').style.backgroundColor = this.value;
  document.getElementById('preview-btn-primary').style.borderColor = this.value;
  
  document.querySelectorAll('.bg-primary').forEach(el => {
    el.style.backgroundColor = this.value;
  });
});
</script>

{% endblock %}

