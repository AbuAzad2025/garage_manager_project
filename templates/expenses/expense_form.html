{% extends 'base.html' %}

{% block title %}{{ 'تعديل مصروف' if is_edit else 'إضافة مصروف' }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>{{ 'تعديل مصروف' if is_edit else 'إضافة مصروف' }}</h2>

  {% if form.errors %}
    <div class="alert alert-danger">يرجى تصحيح الحقول المظللة أدناه.</div>
  {% endif %}

  <form method="post" id="expense-form" novalidate>
    {{ form.hidden_tag() }}

    <div class="row g-3">
      <div class="col-md-2">
        {{ form.date.label(class="form-label") }}
        {{ form.date(class="form-control", required=form.date.flags.required) }}
        {% for e in form.date.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-2">
        {{ form.amount.label(class="form-label") }}
        {{ form.amount(class="form-control", inputmode="decimal", required=form.amount.flags.required) }}
        {% for e in form.amount.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-2">
        {{ form.type_id.label(class="form-label") }}
        {{ form.type_id(class="form-select", id="type_id", required=form.type_id.flags.required) }}
        {% for e in form.type_id.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-2" id="employee-field">
        {{ form.employee_id.label(class="form-label") }}
        {{ form.employee_id(class="form-select") }}
        {% for e in form.employee_id.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-2">
        {{ form.paid_to.label(class="form-label") }}
        {{ form.paid_to(class="form-control") }}
        {% for e in form.paid_to.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-2">
        {{ form.payment_method.label(class="form-label") }}
        {{ form.payment_method(class="form-select", required=form.payment_method.flags.required) }}
        {% for e in form.payment_method.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.payment_details.label(class="form-label") }}
        {{ form.payment_details(class="form-control") }}
        {% for e in form.payment_details.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.description.label(class="form-label") }}
        {{ form.description(class="form-control") }}
        {% for e in form.description.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.tax_invoice_number.label(class="form-label") }}
        {{ form.tax_invoice_number(class="form-control") }}
        {% for e in form.tax_invoice_number.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.notes.label(class="form-label") }}
        {{ form.notes(class="form-control", rows="2") }}
        {% for e in form.notes.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.warehouse_id.label(class="form-label") }}
        {{ form.warehouse_id(class="form-select") }}
        {% for e in form.warehouse_id.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>

      <div class="col-md-3">
        {{ form.partner_id.label(class="form-label") }}
        {{ form.partner_id(class="form-select") }}
        {% for e in form.partner_id.errors %}<small class="text-danger">{{ e }}</small>{% endfor %}
      </div>
    </div>

    <div class="mt-4 d-flex gap-2">
      <button class="btn btn-primary">{{ 'تحديث' if is_edit else 'حفظ' }}</button>
      <a href="{{ url_for('expenses_bp.list_expenses') }}" class="btn btn-secondary">إلغاء</a>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/expenses.js') }}"></script>
{% endblock %}
