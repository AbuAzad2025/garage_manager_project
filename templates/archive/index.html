{% extends "base.html" %}
{% block title %}ุฅุฏุงุฑุฉ ุงูุฃุฑุดููุงุช{% endblock %}
{% block page_header %}๐ฆ ุฅุฏุงุฑุฉ ุงูุฃุฑุดููุงุช ุงูุดุงููุฉ{% endblock %}

{% block content %}
<div class="container my-4">
  
  <!-- ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <div class="card border-0 shadow-lg text-center" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="card-body text-white">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <i class="fas fa-archive fa-2x opacity-75"></i>
            <span class="badge bg-light text-primary fs-6">{{ total_archives }}</span>
          </div>
          <h5 class="fw-bold">ุฅุฌูุงูู ุงูุฃุฑุดููุงุช</h5>
          <p class="mb-0 opacity-75">ุฌููุน ุงูุณุฌูุงุช ุงููุคุฑุดูุฉ</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-lg text-center" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
        <div class="card-body text-white">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <i class="fas fa-calendar fa-2x opacity-75"></i>
            <span class="badge bg-light text-danger fs-6">{{ monthly_archives }}</span>
          </div>
          <h5 class="fw-bold">ูุฐุง ุงูุดูุฑ</h5>
          <p class="mb-0 opacity-75">ุฃุฑุดููุงุช ุงูุดูุฑ ุงูุญุงูู</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-lg text-center" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
        <div class="card-body text-white">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <i class="fas fa-search fa-2x opacity-75"></i>
            <span class="badge bg-light text-success fs-6">{{ type_stats|length }}</span>
          </div>
          <h5 class="fw-bold">ุฃููุงุน ุงูุณุฌูุงุช</h5>
          <p class="mb-0 opacity-75">ุฃููุงุน ูุฎุชููุฉ ูุคุฑุดูุฉ</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-lg text-center" style="background: linear-gradient(135deg, #f12711 0%, #f5af19 100%);">
        <div class="card-body text-white">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <i class="fas fa-database fa-2x opacity-75"></i>
            <span class="badge bg-light text-warning fs-6">100%</span>
          </div>
          <h5 class="fw-bold">ุฃูุงู ุงูุจูุงูุงุช</h5>
          <p class="mb-0 opacity-75">ุญูุธ ุขูู ูููุญุงุณุจุฉ</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ุฅุญุตุงุฆูุงุช ุญุณุจ ุงูููุน -->
  <div class="row g-3 mb-4">
    <div class="col-md-6">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-gradient-primary text-white">
          <h5 class="mb-0"><i class="fas fa-chart-pie"></i> ุชูุฒูุน ุงูุฃุฑุดููุงุช ุญุณุจ ุงูููุน</h5>
        </div>
        <div class="card-body">
          {% if type_stats %}
          <div class="table-responsive">
            <table class="table table-hover">
              <thead class="table-light">
                <tr>
                  <th>ููุน ุงูุณุฌู</th>
                  <th>ุงูุนุฏุฏ</th>
                  <th>ุงููุณุจุฉ</th>
                </tr>
              </thead>
              <tbody>
                {% for stat in type_stats %}
                <tr>
                  <td>
                    {% if stat.record_type == 'service_requests' %}
                    <i class="fas fa-tools text-primary"></i> ุทูุจุงุช ุงูุตูุงูุฉ
                    {% elif stat.record_type == 'payments' %}
                    <i class="fas fa-credit-card text-success"></i> ุงูุฏูุนุงุช
                    {% elif stat.record_type == 'sales' %}
                    <i class="fas fa-shopping-cart text-info"></i> ุงููุจูุนุงุช
                    {% elif stat.record_type == 'expenses' %}
                    <i class="fas fa-receipt text-warning"></i> ุงููููุงุช
                    {% elif stat.record_type == 'checks' %}
                    <i class="fas fa-money-check text-danger"></i> ุงูุดููุงุช
                    {% else %}
                    <i class="fas fa-file text-secondary"></i> {{ stat.record_type }}
                    {% endif %}
                  </td>
                  <td><span class="badge bg-primary">{{ stat.count }}</span></td>
                  <td>
                    <div class="progress" style="height: 20px;">
                      <div class="progress-bar bg-info" style="width: {{ (stat.count / total_archives * 100)|round(1) }}%">
                        {{ (stat.count / total_archives * 100)|round(1) }}%
                      </div>
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center p-4">
            <i class="fas fa-archive fa-3x text-muted mb-3"></i>
            <h5 class="text-muted">ูุง ุชูุฌุฏ ุฃุฑุดููุงุช</h5>
            <p class="text-muted">ูู ูุชู ุฃุฑุดูุฉ ุฃู ุณุฌูุงุช ุจุนุฏ</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-gradient-info text-white">
          <h5 class="mb-0"><i class="fas fa-clock"></i> ุขุฎุฑ ุงูุฃุฑุดููุงุช</h5>
        </div>
        <div class="card-body">
          {% if recent_archives %}
          <div class="list-group list-group-flush">
            {% for archive in recent_archives %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong>
                  {% if archive.record_type == 'service_requests' %}
                  <i class="fas fa-tools text-primary"></i> ุทูุจ ุตูุงูุฉ
                  {% elif archive.record_type == 'payments' %}
                  <i class="fas fa-credit-card text-success"></i> ุฏูุนุฉ
                  {% elif archive.record_type == 'sales' %}
                  <i class="fas fa-shopping-cart text-info"></i> ูุจูุนุฉ
                  {% elif archive.record_type == 'expenses' %}
                  <i class="fas fa-receipt text-warning"></i> ูููุฉ
                  {% elif archive.record_type == 'checks' %}
                  <i class="fas fa-money-check text-danger"></i> ุดูู
                  {% else %}
                  <i class="fas fa-file text-secondary"></i> {{ archive.record_type }}
                  {% endif %}
                  #{{ archive.record_id }}
                </strong>
                <br>
                <small class="text-muted">{{ archive.archive_reason or 'ุจุฏูู ุณุจุจ' }}</small>
              </div>
              <div class="text-end">
                <small class="text-muted">{{ archive.archived_at.strftime('%Y-%m-%d') }}</small>
                <br>
                <a href="{{ url_for('archive.view_archive', archive_id=archive.id) }}" class="btn btn-sm btn-outline-primary">
                  <i class="fas fa-eye"></i> ุนุฑุถ
                </a>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="text-center p-4">
            <i class="fas fa-clock fa-3x text-muted mb-3"></i>
            <h5 class="text-muted">ูุง ุชูุฌุฏ ุฃุฑุดููุงุช ุญุฏูุซุฉ</h5>
            <p class="text-muted">ูู ูุชู ุฃุฑุดูุฉ ุฃู ุณุฌูุงุช ูุคุฎุฑุงู</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- ุฃุฏูุงุช ุงูุฃุฑุดูู -->
  <div class="row g-3">
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-search fa-3x text-primary mb-3"></i>
          <h5>ุงูุจุญุซ ูู ุงูุฃุฑุดููุงุช</h5>
          <p class="text-muted">ุงุจุญุซ ูู ุงูุณุฌูุงุช ุงููุคุฑุดูุฉ</p>
          <a href="{{ url_for('archive.search') }}" class="btn btn-primary fw-bold">
            <i class="fas fa-search"></i> ุจุญุซ ูุชูุฏู
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-layer-group fa-3x text-warning mb-3"></i>
          <h5>ุฃุฑุดูุฉ ุฌูุงุนูุฉ</h5>
          <p class="text-muted">ุฃุฑุดู ุนุฏุฉ ุณุฌูุงุช ูุนุงู</p>
          <a href="{{ url_for('archive.bulk_archive') }}" class="btn btn-warning fw-bold">
            <i class="fas fa-layer-group"></i> ุฃุฑุดูุฉ ุฌูุงุนูุฉ
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-download fa-3x text-success mb-3"></i>
          <h5>ุชุตุฏูุฑ ุงูุฃุฑุดููุงุช</h5>
          <p class="text-muted">ุตุฏูุฑ ุงูุฃุฑุดููุงุช ูููุณุฎ ุงูุงุญุชูุงุทู</p>
          <a href="{{ url_for('archive.export_archives') }}" class="btn btn-success fw-bold">
            <i class="fas fa-download"></i> ุชุตุฏูุฑ
          </a>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

