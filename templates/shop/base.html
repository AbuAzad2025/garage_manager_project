<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}متجرنا الإلكتروني - شركة ازاد للأنظمة الذكية{% endblock %}</title>
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <meta name="csrf-token" content="{{ csrf_token() }}">
  {% block head_extra %}{% endblock %}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  {% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/shop.css') }}">
  {% endblock %}
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top shadow-sm nav-glow modern-nav">
  <div class="container">
    <a class="navbar-brand fw-bold" href="{{ url_for('shop.catalog') }}">
      <div class="brand-logo">
        <i class="fas fa-store me-2"></i>
        <span>متجرنا الإلكتروني</span>
      </div>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#shopNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="shopNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        {% set active_catalog = request.endpoint in ['shop.catalog', 'shop.products'] %}
        <li class="nav-item">
          <a class="nav-link {{ 'active' if active_catalog }}" href="{{ url_for('shop.catalog') }}" {% if active_catalog %}aria-current="page"{% endif %}>المنتجات</a>
        </li>
        {% if current_user.is_authenticated %}
        {% set active_orders = request.endpoint and request.endpoint.startswith('shop.preorder_') %}
        <li class="nav-item">
          <a class="nav-link {{ 'active' if active_orders }}" href="{{ url_for('shop.preorder_list') }}" {% if active_orders %}aria-current="page"{% endif %}>طلباتي</a>
        </li>
        {% endif %}
        {% set can_manage_shop = has_any('manage_shop','manage_inventory') %}
        {% set can_view_reports = has_any('view_reports','manage_reports') %}
        {% set can_view_cards = has_any('manage_payments','view_reports','manage_reports') %}
        {% if can_manage_shop or can_view_reports or can_view_cards %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown">
            <i class="fas fa-shield-halved me-1"></i> لوحة الإدارة
          </a>
          <ul class="dropdown-menu">
            {% if can_manage_shop %}
            <li><a class="dropdown-item" href="{{ url_for('shop.admin_products') }}"><i class="fas fa-cogs me-2"></i> إدارة المنتجات</a></li>
            {% if 'shop.admin_preorders' in current_app.view_functions %}
            <li><a class="dropdown-item" href="{{ url_for('shop.admin_preorders') }}"><i class="fas fa-clipboard-list me-2"></i> تقرير الحجوزات</a></li>
            {% endif %}
            {% endif %}
            {% if can_view_cards and 'admin_reports.cards' in current_app.view_functions %}
            <li><a class="dropdown-item" href="{{ url_for('admin_reports.cards') }}"><i class="fas fa-credit-card me-2"></i> تقرير معاملات البطاقات</a></li>
            {% endif %}
          </ul>
        </li>
        {% endif %}
      </ul>
      <div class="d-flex align-items-center gap-3">
        <a href="{{ url_for('shop.cart') }}" class="btn btn-light position-relative" title="سلة المشتريات">
          <i class="fas fa-shopping-cart"></i>
          <span id="cart-counter" class="quantity-badge badge bg-danger rounded-circle">{{ cart_count|default(0)|int }}</span>
        </a>
        {% if current_user.is_authenticated %}
        <div class="dropdown">
          <button class="btn btn-outline-light dropdown-toggle" type="button" data-toggle="dropdown">
            <i class="fas fa-user me-2"></i> {{ current_user.name or current_user.username }}
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="{{ url_for('shop.preorder_list') }}">طلباتي</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a href="#" class="dropdown-item text-danger" onclick="event.preventDefault();document.getElementById('logout-form-shop').submit();">تسجيل الخروج</a></li>
          </ul>
        </div>
        <form id="logout-form-shop" action="{{ url_for('auth.logout') }}" method="POST" style="display:none;">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        </form>
        {% else %}
        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-light"><i class="fas fa-sign-in-alt me-2"></i> تسجيل الدخول</a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>
<main class="main-content">
  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  {% for category, message in messages %}
  <div class="alert alert-{{ category or 'info' }} alert-dismissible fade show modern-alert" role="alert">
    <i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-triangle' if category == 'warning' else 'info-circle' }} me-2"></i>
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="إغلاق"></button>
  </div>
  {% endfor %}
  {% endif %}
  {% endwith %}
  {% block content %}{% endblock %}
</main>
<footer class="modern-footer">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 col-md-6 mb-4">
        <div class="footer-section">
          <h5 class="footer-title">
            <i class="fas fa-store me-2"></i>
            متجرنا الإلكتروني
          </h5>
          <p class="footer-description">
            متجر متخصص في قطع غيار السيارات الأصلية بأسعار تنافسية وجودة عالية.
          </p>
          <div class="footer-social">
            <a href="https://wa.me/970562150193" class="social-link whatsapp">
              <i class="fab fa-whatsapp"></i>
            </a>
            <a href="#" class="social-link facebook">
              <i class="fab fa-facebook"></i>
            </a>
            <a href="#" class="social-link instagram">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="#" class="social-link twitter">
              <i class="fab fa-twitter"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="col-lg-2 col-md-6 mb-4">
        <div class="footer-section">
          <h6 class="footer-subtitle">روابط سريعة</h6>
          <ul class="footer-links">
            <li><a href="{{ url_for('shop.catalog') }}">المنتجات</a></li>
            <li><a href="#features">المميزات</a></li>
            <li><a href="#contact">تواصل معنا</a></li>
            <li><a href="{{ url_for('auth.login') }}">تسجيل الدخول</a></li>
          </ul>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 mb-4">
        <div class="footer-section">
          <h6 class="footer-subtitle">خدماتنا</h6>
          <ul class="footer-links">
            <li><a href="#">قطع غيار أصلية</a></li>
            <li><a href="#">توصيل سريع</a></li>
            <li><a href="#">ضمان شامل</a></li>
            <li><a href="#">دعم فني</a></li>
          </ul>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 mb-4">
        <div class="footer-section">
          <h6 class="footer-subtitle">تواصل معنا</h6>
          <div class="footer-contact">
            <div class="contact-item">
              <i class="fas fa-phone me-2"></i>
              <span>+972 56 215 0193</span>
            </div>
            <div class="contact-item">
              <i class="fas fa-envelope me-2"></i>
              <span>info@azad-systems.com</span>
            </div>
            <div class="contact-item">
              <i class="fas fa-map-marker-alt me-2"></i>
              <span>رام الله، فلسطين</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr class="footer-divider">
    <div class="row align-items-center">
      <div class="col-md-6">
        <p class="footer-copyright">
          &copy; {{ now().year }} شركة ازاد للأنظمة الذكية. جميع الحقوق محفوظة.
        </p>
      </div>
      <div class="col-md-6 text-md-end">
        <p class="footer-developer">
          تطوير: <strong>أحمد غنام</strong>
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script src="{{ url_for('static', filename='js/shop.js') }}"></script>
<script>
  // Initialize AOS animations
  AOS.init({
    duration: 1000,
    once: true,
    offset: 100
  });

  // Smooth scrolling for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });

  // Parallax effect for hero section
  window.addEventListener('scroll', () => {
    const scrolled = window.pageYOffset;
    const heroSection = document.querySelector('.hero-section');
    if (heroSection) {
      heroSection.style.transform = `translateY(${scrolled * 0.5}px)`;
    }
  });
</script>
{% block scripts %}{% endblock %}
</body>
</html>
