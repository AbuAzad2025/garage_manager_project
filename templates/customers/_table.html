<div class="table-responsive">
  <table id="customersTable" class="table table-hover table-bordered table-striped align-middle mb-0 text-center">
    <thead class="table-primary">
      <tr>
        <th>#</th>
        <th>Ø§Ù„Ø§Ø³Ù…</th>
        <th>Ø§Ù„Ø¬ÙˆØ§Ù„</th>
        <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
        <th>Ø§Ù„ØªØµÙ†ÙŠÙ</th>
        <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
        <th>Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</th>
      </tr>
    </thead>
    <tbody>
      {% for customer in customers %}
      <tr class="{% if not customer.is_active %}table-secondary{% endif %}">
        <td>{{ loop.index + (pagination.page - 1) * pagination.per_page }}</td>
        <td class="text-start">
          <a href="{{ url_for('customers_bp.customer_detail', customer_id=customer.id) }}" class="fw-bold text-primary">
            {{ customer.name }}
          </a>
        </td>
        <td>{{ customer.phone or '-' }}</td>
        <td>{{ customer.email or '-' }}</td>
        <td>{{ customer.category or '-' }}</td>
        <td class="fw-bold {% if customer.balance_in_ils > 0 %}text-danger{% else %}text-success{% endif %}">
          {{ customer.balance_in_ils|format_currency }} â‚ª
        </td>
        <td>{{ customer.is_active|yes_no }}</td>
        <td>{{ customer.created_at|format_date }}</td>
        <td class="text-nowrap">
          <div class="btn-group btn-group-sm" role="group">
            <a href="{{ url_for('customers_bp.customer_detail', customer_id=customer.id) }}"
               class="btn btn-info" title="ØªÙØ§ØµÙŠÙ„"><i class="fas fa-eye"></i></a>
            <a href="{{ url_for('customers_bp.edit_customer', customer_id=customer.id) }}"
               class="btn btn-warning" title="ØªØ¹Ø¯ÙŠÙ„"><i class="fas fa-edit"></i></a>
            {% if customer.is_archived %}
            <button type="button" class="btn btn-success" title="Ø§Ø³ØªØ¹Ø§Ø¯Ø©" onclick="console.log('ğŸ”˜ [TEMPLATE] ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø±Ù‚Ù…: {{ customer.id }}'); restoreCustomer({{ customer.id }})">
              <i class="fas fa-undo"></i>
            </button>
            {% else %}
            <button type="button" class="btn btn-warning" title="Ø£Ø±Ø´ÙØ©" onclick="console.log('ğŸ”˜ [TEMPLATE] ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø£Ø±Ø´ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø±Ù‚Ù…: {{ customer.id }}'); archiveCustomer({{ customer.id }})">
              <i class="fas fa-archive"></i>
            </button>
            {% endif %}
            <button type="button" class="btn btn-danger delete-btn"
                    data-id="{{ customer.id }}"
                    data-delete-url="{{ url_for('customers_bp.delete_customer', id=customer.id) }}"
                    title="Ø­Ø°Ù Ø¹Ø§Ø¯ÙŠ">
              <i class="fas fa-trash"></i>
            </button>
            <a href="{{ url_for('hard_delete_bp.delete_customer', customer_id=customer.id) }}"
               class="btn btn-outline-danger" title="Ø­Ø°Ù Ù‚ÙˆÙŠ"
               onclick="return confirm('Ø­Ø°Ù Ù‚ÙˆÙŠ - Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©!')">
              <i class="fas fa-bomb"></i>
            </a>
            {% if customer.balance and customer.balance > 0 %}
            <a href="{{ url_for('payments.create_payment', 
                               entity_type='CUSTOMER', 
                               entity_id=customer.id,
                               amount=customer.balance,
                               currency=customer.currency if customer.currency else 'ILS',
                               reference='Ø¯ÙØ¹ Ù…Ù† Ø¹Ù…ÙŠÙ„: ' ~ customer.name,
                               notes='Ø¯ÙØ¹Ø© Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„: ' ~ customer.name ~ ((' - Ù‡Ø§ØªÙ: ' ~ customer.phone) if customer.phone else ''),
                               customer_id=customer.id) }}"
               class="btn btn-success" title="Ø¯ÙØ¹ ({{ '%.2f'|format(customer.balance) }} â‚ª)"><i class="fas fa-coins"></i></a>
            {% endif %}
            <a href="{{ url_for('customers_bp.account_statement', customer_id=customer.id) }}"
               class="btn btn-outline-primary" title="ÙƒØ´Ù Ø­Ø³Ø§Ø¨"><i class="fas fa-file-invoice"></i></a>
            <a href="{{ url_for('reports_bp.customer_detail_report', customer_id=customer.id) }}"
               class="btn btn-outline-info" title="ÙƒØ´Ù Ù…ÙØµÙ„"><i class="fas fa-chart-line"></i></a>
            <a href="{{ url_for('customers_bp.customer_whatsapp', customer_id=customer.id) }}"
               class="btn btn-success" title="ÙˆØ§ØªØ³Ø§Ø¨"><i class="fab fa-whatsapp"></i></a>
            <a href="{{ url_for('customers_bp.export_customer_vcf', customer_id=customer.id) }}"
               class="btn btn-outline-success" title="VCF"><i class="fas fa-download"></i></a>
          </div>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="9" class="text-muted text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
