{% extends 'base.html' %}
{% block title %}تصدير جهات اتصال{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb bg-white px-3 py-2 rounded mb-4">
    <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}"><i class="fas fa-home"></i> الرئيسية</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('customers.list_customers') }}">العملاء</a></li>
    <li class="breadcrumb-item active">تصدير جهات اتصال</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-header bg-primary text-white">
    <h3 class="card-title"><i class="fas fa-address-book me-2"></i>تصدير جهات اتصال العملاء</h3>
  </div>
  <div class="card-body">
    <form method="POST" id="export-form">
      {{ form.hidden_tag() }}
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label fw-bold">اختر العملاء</label>
          <select class="form-select" name="customer_ids" multiple size="8">
            {% for cust in customers %}
              <option value="{{ cust.id }}" selected>
                {{ cust.name }} — {{ cust.phone or '-' }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label fw-bold">الحقول المطلوبة</label>
          {% for field,label in [
            ('name','الاسم'),
            ('phone','الجوال'),
            ('whatsapp','واتساب'),
            ('email','البريد الإلكتروني'),
            ('address','العنوان'),
            ('notes','ملاحظات')
          ] %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="fields" value="{{ field }}" id="field-{{ field }}" checked>
            <label class="form-check-label" for="field-{{ field }}">{{ label }}</label>
          </div>
          {% endfor %}
          <div class="mt-4">
            <label class="form-label fw-bold">صيغة التصدير</label>
            <select class="form-select" name="format">
              <option value="vcf">vCard (VCF)</option>
              <option value="csv">CSV</option>
              <option value="excel">Excel</option>
            </select>
          </div>
        </div>
        <div class="col-12 text-end mt-4">
          <button type="submit" class="btn btn-success">
            <i class="fas fa-download me-1"></i> تصدير المحدد
          </button>
          <a href="{{ url_for('customers.export_customers', format='pdf') }}" class="btn btn-outline-primary">
            <i class="fas fa-download me-1"></i> تصدير PDF الكل
          </a>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock %}
