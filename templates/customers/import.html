{% extends 'base.html' %}

{% block title %}استيراد عملاء{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb bg-white px-3 py-2 rounded mb-4">
    <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}">الرئيسية</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('customers_bp.list_customers') }}">العملاء</a></li>
    <li class="breadcrumb-item active">استيراد</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<div class="content-wrapper">
  <div class="card shadow-sm rounded">
    <div class="card-header bg-primary text-white">
      <h5 class="card-title m-0"><i class="fas fa-file-import me-2"></i> استيراد عملاء من ملف CSV</h5>
    </div>
    <div class="card-body">

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for cat, msg in messages %}
            <div class="alert alert-{{ 'warning' if cat == 'warning' else cat }} alert-dismissible fade show" role="alert">
              {{ msg|safe }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="إغلاق"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="post" enctype="multipart/form-data" id="import-form" action="{{ url_for('customers_bp.import_customers') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        {% include 'customers/_import_form.html' %}
        <div class="mt-4 d-flex flex-wrap gap-2">
          <button type="submit" class="btn btn-success">
            <i class="fas fa-upload me-1"></i> استيراد
          </button>
          <a href="{{ url_for('customers_bp.list_customers') }}" class="btn btn-secondary">إلغاء</a>
        </div>
      </form>

    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    document.getElementById('import-form')?.addEventListener('submit', function () {
      // يمكن إضافة مؤشر تحميل لاحقاً
    });
  </script>
{% endblock %}
