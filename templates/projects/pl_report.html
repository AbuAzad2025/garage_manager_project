{% extends 'base.html' %}
{% block title %}Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„ - {{ project.name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/print.css') }}">
{% endblock %}
{% block page_title %}ğŸ“ˆ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„ - {{ project.name }}{% endblock %}

{% block content %}
<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1 class="m-0">
                    <i class="fas fa-file-invoice-dollar text-primary"></i> 
                    ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±
                </h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-left">
                    <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('advanced.accounting_control') }}"><i class="fas fa-sliders-h"></i> Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('projects.index') }}">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</a></li>
                    <li class="breadcrumb-item active">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<section class="content">
<div class="container-fluid">
  
  <div class="row mb-3 no-print">
    <div class="col-12">
      <div class="btn-group">
        <a href="{{ url_for('projects.index') }}" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-left"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
        </a>
        <button class="btn btn-secondary" onclick="window.print()">
          <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
        </button>
      </div>
    </div>
  </div>

  
  <div class="card border-0 shadow-sm">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„ - {{ project.code }}</h5>
    </div>
    <div class="card-body">
      <table class="table table-bordered">
        <thead class="table-light">
          <tr><th colspan="2">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th></tr>
        </thead>
        <tbody>
          {% for type, total in revenues_by_type %}
          <tr>
            <td>{{ translations.project_revenue_type.get(type, type) }}</td>
            <td class="text-end">{{ "{:,.2f}".format(total) }} â‚ª</td>
          </tr>
          {% endfor %}
          <tr class="table-success">
            <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th>
            <th class="text-end">{{ "{:,.2f}".format(project.actual_revenue or 0) }} â‚ª</th>
          </tr>
        </tbody>
      </table>

      <table class="table table-bordered mt-3">
        <thead class="table-light">
          <tr><th colspan="2">Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</th></tr>
        </thead>
        <tbody>
          {% for type, total in costs_by_type %}
          <tr>
            <td>{{ translations.project_cost_type.get(type, type) }}</td>
            <td class="text-end">{{ "{:,.2f}".format(total) }} â‚ª</td>
          </tr>
          {% endfor %}
          <tr class="table-danger">
            <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</th>
            <th class="text-end">{{ "{:,.2f}".format(project.actual_cost or 0) }} â‚ª</th>
          </tr>
        </tbody>
      </table>

      <table class="table table-bordered mt-3">
        <tbody>
          <tr class="{% if project.get_profit() >= 0 %}table-success{% else %}table-danger{% endif %}">
            <th>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©</th>
            <th class="text-end">{{ "{:,.2f}".format(project.get_profit()) }} â‚ª</th>
          </tr>
          <tr>
            <th>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</th>
            <th class="text-end">{{ "{:.1f}".format(project.get_profit_margin()) }}%</th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="mt-3">
    <a href="{{ url_for('projects.view_project', id=project.id) }}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Ø±Ø¬ÙˆØ¹
    </a>
    <button onclick="window.print()" class="btn btn-primary">
      <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
    </button>
  </div>

</div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/print.js') }}"></script>
{% endblock %}

