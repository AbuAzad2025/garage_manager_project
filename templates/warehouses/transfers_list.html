{% extends 'warehouses/base.html' %}
{% block title %}تحويلات {{ warehouse.name }}{% endblock %}
{% block page_title %}تحويلات مستودع {{ warehouse.name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h5 class="mb-0">
    <i class="fas fa-exchange-alt text-info me-1"></i>
    تحويلات المستودع: <strong>{{ warehouse.name }}</strong>
    <span class="badge bg-secondary">{{ transfers|length }}</span>
  </h5>
  {% if current_user.has_permission('manage_inventory') %}
    <a href="{{ url_for('warehouses.list_transfers', warehouse_id=warehouse.id) }}" class="btn btn-sm btn-success">
      <i class="fas fa-random me-1"></i> إضافة تحويل
    </a>
  {% endif %}
</div>

<div class="card shadow-sm">
  <div class="card-body table-responsive">
    <table id="transfersTable" class="table table-striped table-hover align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>#</th>
          <th>التاريخ</th>
          <th>الصنف</th>
          <th>من</th>
          <th>إلى</th>
          <th class="text-center">الكمية</th>
          <th>المستخدم</th>
        </tr>
      </thead>
      <tbody>
        {% for t in transfers %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ t.transfer_date.strftime('%Y-%m-%d') }}</td>
          <td>{{ t.product.name }}</td>
          <td>{{ t.source_warehouse.name }}</td>
          <td>{{ t.destination_warehouse.name }}</td>
          <td class="text-center">{{ t.quantity }}</td>
          <td>{{ t.user.username if t.user else '—' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    $(function () {
      $('#transfersTable').DataTable({
        pageLength: 25,
        language: { url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/ar.json' }
      });
    });
  </script>
{% endblock %}
