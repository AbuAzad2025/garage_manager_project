{% extends 'warehouses/base.html' %}
{% block title %}قطع المستودعات{% endblock %}
{% block page_title %}عرض المخزون عبر مستودعات محددة{% endblock %}
{% block head_extra %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/warehouses.css') }}">
{% endblock %}
{% block content %}
<form class="row g-2 mb-3" method="get">
  <div class="col-md-9">
    <select class="form-control" name="warehouse_ids" multiple size="5">
      {% for w in warehouses %}
        <option value="{{ w.id }}" {% if w.id in selected_ids %}selected{% endif %}>{{ w.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3 text-end">
    <button class="btn btn-primary">تطبيق</button>
    <a class="btn btn-secondary" href="{{ url_for('warehouse_bp.detail', warehouse_id=active_warehouse_id) }}">رجوع للتفاصيل</a>
  </div>
</form>
<table class="table table-striped" id="stock-table">
  <thead><tr><th>القطعة</th><th>المستودع</th><th>الكمية</th><th>حد أدنى</th></tr></thead>
  <tbody>
    {% for sl in stock_levels %}
      <tr>
        <td><a href="{{ url_for('warehouse_bp.product_card', product_id=sl.product.id) }}">{{ sl.product.name }}</a></td>
        <td>{{ sl.warehouse.name }}</td>
        <td>{{ sl.quantity }}</td>
        <td>{{ sl.min_stock or 0 }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/warehouses.js') }}"></script>
  <script>$(function(){ $('#stock-table').DataTable({pageLength:25}); });</script>
{% endblock %}
