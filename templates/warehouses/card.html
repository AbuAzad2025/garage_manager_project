{% extends 'warehouses/base.html' %}
{% block title %}بطاقة القطعة{% endblock %}
{% block page_title %}بطاقة القطعة{% endblock %}

{% block content %}
<div class="card mb-3"><div class="card-body">
  <h4 class="mb-2">{{ part.name }}</h4>
  <div class="text-muted">رقم القطعة: {{ part.part_number or '—' }} | الباركود: {{ part.barcode or '—' }}</div>
</div></div>

<h5>المخزون عبر المستودعات</h5>
<table class="table table-bordered">
  <thead><tr><th>المستودع</th><th>متوفر</th><th>محجوز</th><th>المتاح الفعلي</th></tr></thead>
  <tbody>
  {% for row in stock %}
    <tr><td>{{ row.warehouse.name }}</td><td>{{ row.on_hand }}</td><td>{{ row.reserved }}</td><td>{{ row.virtual_available }}</td></tr>
  {% endfor %}
  </tbody>
</table>

<div class="row">
  <div class="col-md-6">
    <h5>تحويلات</h5>
    <ul class="list-group">
      {% for t in transfers %}
        <li class="list-group-item small">
          {{ t.transfer_date.strftime('%Y-%m-%d') if t.transfer_date }} — {{ t.source_warehouse.name if t.source_warehouse }} → {{ t.destination_warehouse.name if t.destination_warehouse }} ({{ t.quantity }})
        </li>
      {% else %}
        <li class="list-group-item">لا يوجد</li>
      {% endfor %}
    </ul>
  </div>
  <div class="col-md-6">
    <h5>شحنات</h5>
    <ul class="list-group">
      {% for si in shipments %}
        <li class="list-group-item small">
          {{ si.shipment.shipment_number if si.shipment }} — {{ si.warehouse.name if si.warehouse }} ({{ si.quantity }})
        </li>
      {% else %}
        <li class="list-group-item">لا يوجد</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}
