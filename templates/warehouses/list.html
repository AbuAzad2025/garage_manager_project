{# File: templates/warehouses/list.html #}
{% extends 'warehouses/base.html' %}

{% block title %}قائمة المستودعات{% endblock %}
{% block page_title %}المستودعات{% endblock %}

{% block head_extra %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/warehouses.css') }}">
{% endblock %}

{% block content %}
<div class="card">
  <div class="card-body">

    <form class="row g-2 mb-3" method="get" action="{{ url_for('warehouse_bp.list') }}">
      <div class="col-md-3">
        <select class="form-control" name="type">
          <option value="">كل الأنواع</option>
          <option value="MAIN"      {{ 'selected' if (filter_type|upper) == 'MAIN' }}>MAIN</option>
          <option value="INVENTORY" {{ 'selected' if (filter_type|upper) == 'INVENTORY' }}>INVENTORY</option>
          <option value="PARTNER"   {{ 'selected' if (filter_type|upper) == 'PARTNER' }}>PARTNER</option>
          <option value="EXCHANGE"  {{ 'selected' if (filter_type|upper) == 'EXCHANGE' }}>EXCHANGE</option>
        </select>
      </div>
      <div class="col-md-5">
        <input class="form-control" type="text" name="search" placeholder="ابحث بالاسم" value="{{ search or '' }}">
      </div>
      <div class="col-md-2">
        <button class="btn btn-primary w-100" type="submit">تصفية</button>
      </div>
      <div class="col-md-2">
        <a class="btn btn-light w-100" href="{{ url_for('warehouse_bp.list') }}">إلغاء</a>
      </div>
    </form>

    {% if warehouses and warehouses|length %}
      <table class="table table-striped" id="warehouses-table">
        <thead>
          <tr>
            <th>الاسم</th>
            <th>النوع</th>
            <th>نشط؟</th>
          </tr>
        </thead>
        <tbody>
          {% for w in warehouses %}
          <tr>
            <td><a href="{{ url_for('warehouse_bp.detail', warehouse_id=w.id) }}">{{ w.name }}</a></td>
            <td>{{ w.warehouse_type }}</td>
            <td>{{ '✓' if w.is_active else '✗' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="alert alert-info mb-0">لا توجد مستودعات.</div>
    {% endif %}

  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    (function() {
      if (window.jQuery && $.fn.DataTable) {
        $('#warehouses-table').DataTable({ pageLength: 25 });
      }
    })();
  </script>
{% endblock %}
