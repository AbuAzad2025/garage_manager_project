=== تحسينات بنود الفاتورة - Sale Line Enhancements ===
تاريخ: 2025-10-24

## 1. التعديلات على Backend:

### models.py:
- إضافة حقل `line_receiver` (VARCHAR 200) لحفظ اسم مستلم البضاعة لكل بند
- الحقل `note` كان موجوداً بالفعل

### forms.py:
- إضافة `line_receiver` إلى `SaleLineForm`

### routes/sales.py:
- تحديث `_attach_lines` لحفظ `line_receiver`

---

## 2. التعديلات على Frontend:

### templates/sales/form.html:
- تغيير Grid Layout من:
  `2fr 4fr 1fr 1fr 2fr`
  إلى:
  `0.6fr 2fr 1.2fr 1.2fr 1.5fr 2fr 1fr`
  (رقم مستودع | منتج | كمية | سعر | مستلم | ملاحظات | إجراءات)

- تصغير خط المنتج: `.product-select{font-size:0.85rem !important}`
- جعل الكمية والسعر ديناميكيين: `input[type="number"]{min-width:80px}`
- عرض رقم المستودع (#ID) بدلاً من الاسم الكامل

### static/js/sales.js:
- إضافة event handler لعرض رقم المستودع بعد الاختيار

---

## 3. تبسيط Simple Invoice:

### templates/sales/receipt_simple.html:
- إزالة **كل الهيدرات** ما عدا التاريخ
- حذف اسم الشركة
- حذف معلومات العميل
- الهيدر الآن: فقط "التاريخ: YYYY-MM-DD"

---

## 4. التهجير (Migration):

### محلياً (تم):
```sql
ALTER TABLE sale_lines ADD COLUMN line_receiver VARCHAR(200);
```

### PythonAnywhere:
```bash
cd ~/garage_manager_project
git pull origin main

python3.10 << 'EOF'
from app import create_app, db
from sqlalchemy import text
app = create_app()
with app.app_context():
    try:
        result = db.session.execute(text("PRAGMA table_info(sale_lines)")).fetchall()
        columns = [row[1] for row in result]
        if 'line_receiver' not in columns:
            db.session.execute(text("ALTER TABLE sale_lines ADD COLUMN line_receiver VARCHAR(200)"))
            db.session.commit()
            print('Done')
        else:
            print('Already exists')
    except:
        print('Error')
        db.session.rollback()
EOF

touch /var/www/palkaraj-azad_pythonanywhere_com_wsgi.py
```

---

## ✅ الخلاصة:
1. ✅ models.py: line_receiver added
2. ✅ forms.py: line_receiver field
3. ✅ routes/sales.py: saving line_receiver
4. ✅ templates/sales/form.html: new grid + warehouse #ID + line_receiver + note
5. ✅ static/js/sales.js: warehouse #ID display
6. ✅ templates/sales/receipt_simple.html: date only header
7. ✅ Migration: local done

