"""
AI ECU Knowledge - ูุนุฑูุฉ ููุจููุชุฑุงุช ุงููุนุฏุงุช
ECUุ OBDุ ุงูุชุดุฎูุต ุงูุฅููุชุฑููู
"""

# ====================================================================
# ููุจููุชุฑุงุช ุงูุณูุงุฑุงุช ECU
# ====================================================================

ECU_KNOWLEDGE = {
    'basics': {
        'name': 'ECU - ูุญุฏุฉ ุงูุชุญูู ุงูุฅููุชุฑูููุฉ',
        'full_name': 'Engine Control Unit',
        'function': 'ุงูููุจููุชุฑ ุงูุฑุฆูุณู ุงูุฐู ูุชุญูู ูู ุงููุญุฑู',
        'what_it_controls': [
            'ูููุฉ ุงููููุฏ ุงููุญููู',
            'ุชูููุช ุงูุงุดุชุนุงู',
            'ูุณุจุฉ ุงูููุงุก/ุงููููุฏ (AFR)',
            'ุณุฑุนุฉ ุงูุฏูุฑุงู ุงูุฎุงููุฉ (Idle)',
            'ูุฑูุญุฉ ุงูุชุจุฑูุฏ',
            'ูุงูู ุงูุญุฑูุฉ (ูู ุจุนุถ ุงูุณูุงุฑุงุช)'
        ],
        'inputs': [
            'ุญุณุงุณ ุงูุฃูุณุฌูู (O2 Sensor)',
            'ุญุณุงุณ ููุถุน ุนููุฏ ุงููุฑูู (CKP)',
            'ุญุณุงุณ ููุถุน ุนููุฏ ุงููุงูุงุช (CMP)',
            'ุญุณุงุณ ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงููุญุฑู (ECT)',
            'ุญุณุงุณ ุชุฏูู ุงูููุงุก (MAF/MAP)',
            'ุญุณุงุณ ููุถุน ุงูุซุฑูุชู (TPS)'
        ],
        'outputs': [
            'ุงูุจุฎุงุฎุงุช (Injectors)',
            'ุงูููููุงุช (Ignition Coils)',
            'ูุฑูุญุฉ ุงูุชุจุฑูุฏ',
            'ูุถุฎุฉ ุงููููุฏ'
        ]
    },
    
    'obd_systems': {
        'name': 'OBD - ูุธุงู ุงูุชุดุฎูุต ุงูุฐุงุชู',
        'versions': {
            'OBD-I': 'ูุฏูู - ุณูุงุฑุงุช ูุง ูุจู 1996 - ูู ุดุฑูุฉ ููุง ูุธุงู',
            'OBD-II': 'ููุญุฏ - 1996+ - ุฌููุน ุงูุณูุงุฑุงุช ูู ุฃูุฑููุง ูุฃูุฑูุจุง',
            'EOBD': 'ุฃูุฑูุจู - ูุดุงุจู ูู OBD-II'
        },
        'connector_location': [
            'ุนุงุฏุฉ ุชุญุช ููุญุฉ ุงูููุงุฏุฉ',
            'ูุฑุจ ุนููุฏ ุงูููุงุฏุฉ',
            '16 pin connector (OBD-II)'
        ],
        'what_it_does': [
            'ูุฑุงูุจ ุฌููุน ุงูุญุณุงุณุงุช',
            'ููุชุดู ุงูุฃุนุทุงู ุชููุงุฆูุงู',
            'ูุฎุฒู ุฃููุงุฏ ุงูุฃุนุทุงู (DTCs)',
            'ูุถูุก ููุจุฉ Check Engine ุนูุฏ ูุฌูุฏ ุนุทู'
        ]
    },
    
    'dtc_codes': {
        'name': 'ุฃููุงุฏ ุงูุฃุนุทุงู (DTCs)',
        'format': 'P0XXX, P1XXX, P2XXX, P3XXX',
        'categories': {
            'P0': 'ุฃููุงุฏ ููุญุฏุฉ (ุฌููุน ุงูุณูุงุฑุงุช)',
            'P1': 'ุฃููุงุฏ ุฎุงุตุฉ ุจุงูุดุฑูุฉ ุงููุตูุนุฉ',
            'P2': 'ุฃููุงุฏ ูููุฏ ูููุงุก',
            'P3': 'ุฃููุงุฏ ุงูุงุดุชุนุงู'
        },
        'common_codes': {
            'P0300': {
                'description': 'Random/Multiple Cylinder Misfire',
                'ar': 'ุชูุทูุน ุนุดูุงุฆู ูู ุงููุญุฑู',
                'causes': ['ุจูุงุฌู', 'ููููุงุช', 'ูููุฏ', 'ุถุบุท'],
                'severity': 'ุนุงููุฉ'
            },
            'P0420': {
                'description': 'Catalyst System Efficiency Below Threshold',
                'ar': 'ููุงุกุฉ ุงููุญูู ุงูุญูุงุฒ ููุฎูุถุฉ',
                'causes': ['ูุญูู ุญูุงุฒ ุชุงูู', 'ุญุณุงุณ ุฃูุณุฌูู'],
                'severity': 'ูุชูุณุทุฉ - ูุง ูุคุซุฑ ุนูู ุงูููุงุฏุฉ'
            },
            'P0171': {
                'description': 'System Too Lean',
                'ar': 'ุฎููุท ูููุฑ (ููุงุก ุฃูุซุฑ ูู ุงููููุฏ)',
                'causes': ['ุชุณุฑุจ ููุงุก', 'ููุชุฑ ูููุฏ', 'ุถุบุท ูููุฏ ููุฎูุถ'],
                'severity': 'ูุชูุณุทุฉ'
            },
            'P0128': {
                'description': 'Coolant Thermostat',
                'ar': 'ุซุฑููุณุชุงุช ูุง ูุตู ูุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ',
                'causes': ['ุซุฑููุณุชุงุช ููุชูุญ ุฏุงุฆูุงู'],
                'severity': 'ููุฎูุถุฉ - ุฒูุงุฏุฉ ุงุณุชููุงู'
            }
        }
    },
    
    'scan_tools': {
        'name': 'ุฃุฏูุงุช ุงููุณุญ ูุงูุชุดุฎูุต',
        'types': {
            'basic_code_reader': {
                'name': 'ูุงุฑุฆ ุฃููุงุฏ ุจุณูุท',
                'price': '100-300โช',
                'features': ['ููุฑุฃ ุงูุฃููุงุฏ', 'ููุณุญ ุงูุฃููุงุฏ'],
                'limitations': 'ูุง ูุนุฑุถ ุจูุงูุงุช ุญูุฉ (Live Data)'
            },
            'advanced_scanner': {
                'name': 'ูุงุณุญ ูุชูุฏู',
                'price': '500-2,000โช',
                'features': [
                    'ููุฑุฃ ุงูุฃููุงุฏ',
                    'ูุนุฑุถ ุงูุจูุงูุงุช ุงูุญูุฉ (Live Data)',
                    'ููุนูู/ูููู ุงูุฃูุธูุฉ (Actuator Tests)',
                    'ูุจุฑูุฌ ุจุนุถ ุงูุฃูุธูุฉ'
                ],
                'brands': ['Launch', 'Autel', 'Snap-on']
            },
            'professional': {
                'name': 'ูุธุงู ุชุดุฎูุต ุงุญุชุฑุงูู',
                'price': '3,000-10,000โช+',
                'features': [
                    'ูู ููุฒุงุช ุงููุชูุฏู',
                    'ุฏุนู ุฌููุน ุงูุณูุงุฑุงุช',
                    'ุจุฑูุฌุฉ ECU',
                    'ุถุจุท ุงูุฃูุธูุฉ (Calibration)',
                    'ุฑุณูู ุจูุงููุฉ'
                ],
                'brands': ['Bosch KTS', 'Snap-on MODIS', 'Autel MaxiSys']
            }
        },
        'how_to_use': [
            '1. ุฃูุตู ุงููุงุณุญ ุจูููุฐ OBD',
            '2. ุดุบูู ุงูููุชุงุญ (ูุง ุชุฏุฑ ุงููุญุฑู)',
            '3. ุงุฎุชุฑ ููุน ุงูุณูุงุฑุฉ',
            '4. ุงูุฑุฃ ุงูุฃููุงุฏ (Read Codes)',
            '5. ุงุจุญุซ ุนู ูุนูู ุงูููุฏ',
            '6. ุงูุญุต ุงูุจูุงูุงุช ุงูุญูุฉ',
            '7. ุงูุณุญ ุงูุฃููุงุฏ ุจุนุฏ ุงูุฅุตูุงุญ',
            '8. test drive ูุชุฃูุฏ ูู ุนุฏู ุนูุฏุฉ ุงูููุฏ'
        ]
    },
    
    'heavy_equipment_ecu': {
        'name': 'ููุจููุชุฑุงุช ุงููุนุฏุงุช ุงูุซูููุฉ',
        'brands': {
            'CAT': {
                'name': 'Caterpillar',
                'tool': 'CAT ET (Electronic Technician)',
                'connector': 'ุฎุงุต 6-pin ุฃู 9-pin',
                'features': [
                    'ูุฑุงุกุฉ ุฃููุงุฏ ุงูุฃุนุทุงู',
                    'ูุนุงูุฑุฉ ุงูุฃูุธูุฉ',
                    'ุจุฑูุฌุฉ ECU',
                    'ุชุญุฏูุซ ุงูุณููุชููุฑ'
                ],
                'price': 'ุบุงูู ุฌุฏุงู - ูููููุงุก ุนุงุฏุฉู'
            },
            'Komatsu': {
                'name': 'ูููุงุชุณู',
                'tool': 'KOMTRAX',
                'features': [
                    'ุชุดุฎูุต ุนู ุจุนุฏ',
                    'ุชุชุจุน ุงููุนุฏุฉ GPS',
                    'ุชูุงุฑูุฑ ุงูุตูุงูุฉ'
                ]
            },
            'JCB': {
                'name': 'JCB',
                'tool': 'JCB Service Master',
                'note': 'ูุญุชุงุฌ ุฌูุงุฒ ุฎุงุต'
            }
        },
        'general_note': 'โ๏ธ ูุนุฏุงุช ุซูููุฉ ุชุญุชุงุฌ ุฃุฏูุงุช ุชุดุฎูุต ุฎุงุตุฉ ูููููุฉ - ุฃู ุฒูุงุฑุฉ ูููููู'
    }
}


# ====================================================================
# ุฏูุงู ุงูุชุดุฎูุต ุงูุฅููุชุฑููู
# ====================================================================

def explain_dtc_code(code: str) -> str:
    """ุดุฑุญ ููุฏ ุนุทู DTC"""
    code_upper = code.upper().strip()
    
    common_codes = ECU_KNOWLEDGE['dtc_codes']['common_codes']
    
    if code_upper in common_codes:
        code_info = common_codes[code_upper]
        
        return f"""๐ **ููุฏ ุงูุนุทู: {code_upper}**

๐ **ุงููุตู ุจุงูุฅูุฌููุฒูุฉ:**
{code_info['description']}

๐ **ุงููุตู ุจุงูุนุฑุจูุฉ:**
{code_info['ar']}

๐ง **ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
""" + '\n'.join([f"  โข {cause}" for cause in code_info['causes']]) + f"""

โ๏ธ **ูุณุชูู ุงูุฎุทูุฑุฉ:** {code_info['severity']}

๐ก **ุชูุตูุชู:**
ุงุจุฏุฃ ุจูุญุต ุงูุฃุณุจุงุจ ุงูุฃุฑุฎุต ุฃููุงู (ุงูุญุณุงุณุงุช ุนุงุฏุฉ)
"""
    else:
        return f"""โ **ููุฏ ุบูุฑ ุดุงุฆุน: {code_upper}**

๐ก ุงุจุญุซ ุนู ุงูููุฏ ูู:
  โข Google: "{code_upper} + ููุน ุงูุณูุงุฑุฉ"
  โข ูููุน ุงูุดุฑูุฉ ุงููุตูุนุฉ
  โข ููุชุฏูุงุช ุงูุณูุงุฑุงุช

๐ง ุฃู ุงุณุชุฎุฏู ูุงุณุญ ูุชูุฏู ูุนุฑุถ ุชูุงุตูู ุฃูุซุฑ
"""


def ecu_connection_guide(vehicle_brand: str) -> str:
    """ุฏููู ุชูุตูู ุฌูุงุฒ ุงูุชุดุฎูุต"""
    
    return f"""๐ **ุฏููู ุชูุตูู ุฌูุงุฒ ุงูุชุดุฎูุต:**

๐ **ูููุน ูููุฐ OBD-II:**
โข ุนุงุฏุฉ ุชุญุช ููุญุฉ ุงูููุงุฏุฉ
โข ูุฑุจ ุนููุฏ ุงูููุงุฏุฉ
โข ูุฏ ูููู ูุบุทู ุจุบุทุงุก ุจูุงุณุชูู

๐ง **ุฎุทูุงุช ุงูุชูุตูู:**
1. ุฃุทูุฆ ุงููุญุฑู
2. ุงุจุญุซ ุนู ูููุฐ OBD (16 pin ุนุงุฏุฉู)
3. ุฃูุตู ุงููุงุณุญ ุจุฅุญูุงู
4. ุดุบูู ุงูููุชุงุญ (ON - ูุง ุชุฏุฑ ุงููุญุฑู)
5. ุงูุชุธุฑ 5-10 ุซูุงูู
6. ุงุจุฏุฃ ุงููุฑุงุกุฉ ูู ุงูุฌูุงุฒ

โ๏ธ **ููุงุญุธุงุช:**
โข ูุง ุชูุตู ุงูุฌูุงุฒ ูุงูููุชุงุญ ON
โข ุงููุนุฏุงุช ุงูุซูููุฉ ูุฏ ุชุญุชุงุฌ ููุตู ุฎุงุต
โข ุงุณุชุดุฑ ุฏููู ุงููุนุฏุฉ ุฅุฐุง ูู ุชุฌุฏ ุงููููุฐ

๐ก **ููุฑุงุกุฉ ุงูุฃููุงุฏ ุจุฏูู ุฌูุงุฒ (ุจุนุถ ุงูุณูุงุฑุงุช):**
โข Toyota/Nissan: ุฌุณุฑ ุทุฑูู TE1-E1 ูุดุงูุฏ ูููุถ ููุจุฉ Check Engine
โข ุงููููุถ = ุงูููุฏ (ูุซูุงู: 2 ููุถุงุชุ ุชูููุ 3 ููุถุงุช = ููุฏ 23)
"""

