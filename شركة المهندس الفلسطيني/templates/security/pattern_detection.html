{% extends 'base.html' %}
{% block title %}ÙƒØ´Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø·{% endblock %}
{% block page_title %}ğŸ” ÙƒØ´Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©{% endblock %}

{% block content %}
<div class="container-fluid">
  
  {% include 'security/_navigation.html' %}
  
  <div class="card">
    <div class="card-header bg-danger text-white">
      <h5 class="mb-0">Ø£Ù†Ù…Ø§Ø· Ù…Ø´Ø¨ÙˆÙ‡Ø© ØªÙ… Ø§ÙƒØªØ´Ø§ÙÙ‡Ø§</h5>
    </div>
    <div class="card-body">
      {% if patterns %}
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
                <th>Ø§Ù„Ø®Ø·ÙˆØ±Ø©</th>
                <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
              </tr>
            </thead>
            <tbody>
              {% for pattern in patterns %}
              <tr>
                <td>{{ pattern.type }}</td>
                <td>
                  {% if pattern.ip %}<code>{{ pattern.ip }}</code>{% endif %}
                  {% if pattern.count %} - {{ pattern.count }} Ù…Ø­Ø§ÙˆÙ„Ø©{% endif %}
                </td>
                <td>
                  <span class="badge bg-{{ pattern.severity == 'high' and 'danger' or 'warning' }}">
                    {{ pattern.severity }}
                  </span>
                </td>
                <td>
                  {% if pattern.ip %}
                  <a href="{{ url_for('security.block_ip') }}?ip={{ pattern.ip }}" class="btn btn-sm btn-danger">Ø­Ø¸Ø±</a>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-success text-center py-4">
          <i class="fas fa-check-circle fa-3x mb-3"></i><br>
          Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ù…Ø§Ø· Ù…Ø´Ø¨ÙˆÙ‡Ø©. Ø§Ù„Ù†Ø¸Ø§Ù… Ø¢Ù…Ù†! âœ…
        </p>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}

