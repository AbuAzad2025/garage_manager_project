{% extends "base.html" %}
{% block title %}⚡ مصروف سريع{% endblock %}

{% block content %}
<div class="container mt-4" dir="rtl">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h3 class="mb-0">⚡ إضافة مصروف سريع</h3>
    <a href="{{ url_for('expenses_bp.list_expenses') }}" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-right"></i> رجوع
    </a>
  </div>

  <form method="POST" class="card p-3 needs-validation" novalidate>
    {{ form.hidden_tag() }}
    <div class="row g-3">
      <div class="col-md-4">
        {{ form.date.label(class="form-label") }}
        {{ form.date(type="date", class="form-control") }}
        {% for e in form.date.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4">
        {{ form.amount.label(class="form-label") }}
        {{ form.amount(class="form-control", step="0.01", id="amount") }}
        {% for e in form.amount.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4">
        {{ form.currency.label(class="form-label") }}
        {{ form.currency(class="form-select") }}
        {% for e in form.currency.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        {{ form.type_id.label(class="form-label") }}
        {{ form.type_id(class="form-select", id="type_id") }}
        {% for e in form.type_id.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        {{ form.paid_to.label(class="form-label") }}
        {{ form.paid_to(class="form-control", id="paid_to") }}
        {% for e in form.paid_to.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        {{ form.payment_method.label(class="form-label") }}
        {{ form.payment_method(class="form-select", id="payment_method") }}
        {% for e in form.payment_method.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <div id="methodDetails" class="row gy-2 mt-2" style="display:none;">
      <div class="col-md-4" data-field="check_number">
        {{ form.check_number.label(class="form-label") }}
        {{ form.check_number(class="form-control") }}
        {% for e in form.check_number.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="check_bank">
        {{ form.check_bank.label(class="form-label") }}
        {{ form.check_bank(class="form-control") }}
        {% for e in form.check_bank.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="check_due_date">
        {{ form.check_due_date.label(class="form-label") }}
        {{ form.check_due_date(type="date", class="form-control") }}
        {% for e in form.check_due_date.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6" data-field="bank_transfer_ref">
        {{ form.bank_transfer_ref.label(class="form-label") }}
        {{ form.bank_transfer_ref(class="form-control") }}
        {% for e in form.bank_transfer_ref.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="card_number">
        {{ form.card_number.label(class="form-label") }}
        {{ form.card_number(class="form-control") }}
        {% for e in form.card_number.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="card_holder">
        {{ form.card_holder.label(class="form-label") }}
        {{ form.card_holder(class="form-control") }}
        {% for e in form.card_holder.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="card_expiry">
        {{ form.card_expiry.label(class="form-label") }}
        {{ form.card_expiry(class="form-control") }}
        {% for e in form.card_expiry.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="online_gateway">
        {{ form.online_gateway.label(class="form-label") }}
        {{ form.online_gateway(class="form-control") }}
        {% for e in form.online_gateway.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-4" data-field="online_ref">
        {{ form.online_ref.label(class="form-label") }}
        {{ form.online_ref(class="form-control") }}
        {% for e in form.online_ref.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <div class="mt-3">
      {{ form.payment_details.label(class="form-label") }}
      {{ form.payment_details(class="form-control") }}
      {% for e in form.payment_details.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
    </div>

    <div class="d-flex gap-2 mt-3">
      <button type="submit" class="btn btn-success"><i class="fas fa-save"></i> حفظ</button>
      <a href="{{ url_for('expenses_bp.list_expenses') }}" class="btn btn-outline-secondary">إلغاء</a>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/expenses.js') }}"></script>
{% endblock %}
