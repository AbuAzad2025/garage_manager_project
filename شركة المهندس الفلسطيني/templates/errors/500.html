<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>500 · خطأ داخلي</title>
<style>
  :root{--bg:#0f172a;--card:#111827;--muted:#94a3b8;--fg:#e5e7eb;--accent:#22c55e;--danger:#ef4444}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 600px at 80% -10%,#1f2937 0,transparent 60%),linear-gradient(180deg,#0b1220 0,#0b1220 40%,#0a0f1c 100%),var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",Tahoma,Arial}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:32px}
  .card{width:100%;max-width:720px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:20px;backdrop-filter:blur(6px);padding:32px 28px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
  .code{font-size:56px;line-height:1;margin:0;color:var(--danger);letter-spacing:2px;font-weight:800}
  .title{margin:.35rem 0 0;font-size:28px;font-weight:700}
  .desc{margin:14px 0 22px;color:var(--muted);line-height:1.8}
  .hint{font-size:13px;color:#9ca3af;margin:10px 0 26px}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;text-decoration:none;display:inline-flex;align-items:center;gap:10px;cursor:pointer;transition:transform .08s ease,opacity .2s ease;user-select:none}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:var(--accent);color:#052e16}
  .btn-ghost{background:transparent;color:var(--fg);border:1px solid rgba(255,255,255,.12)}
  .mono{font-family:ui-monospace,SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace}
  .footer{margin-top:22px;font-size:12px;color:#7c8799}
</style>
</head>
<body>
<div class="wrap">
  <main class="card" role="main" aria-labelledby="err-title">
    <div class="code" aria-hidden="true">500</div>
    <h1 id="err-title" class="title">خطأ داخلي في الخادم</h1>
    <p class="desc">حدث خلل غير متوقع أثناء معالجة الطلب.</p>
    
    <div style="background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.2);border-radius:12px;padding:16px;margin:16px 0;">
      <strong>❌ ماذا حدث؟</strong>
      <ul style="margin:8px 0 0;padding-right:20px;color:#9ca3af;">
        <li>حدث خطأ غير متوقع في الخادم</li>
        <li>تم تسجيل الخطأ تلقائياً للمراجعة</li>
        <li>سيتم إصلاح المشكلة في أقرب وقت</li>
      </ul>
    </div>
    
    <p class="hint mono">
      <strong>رقم المرجع:</strong> {{ request.headers.get('X-Request-Id', 'N/A') }}<br>
      <strong>التاريخ:</strong> {{ now().strftime('%Y-%m-%d %H:%M:%S') if now else '' }}
    </p>
    
    <div class="row">
      <button class="btn btn-primary" type="button" onclick="location.reload()">إعادة المحاولة</button>
      <a class="btn btn-ghost" href="{{ url_for('main.dashboard') }}">اللوحة الرئيسية</a>
      <a class="btn btn-ghost" href="https://wa.me/970562150193?text=خطأ 500 - المسار: {{ path }}" target="_blank">إبلاغ الدعم</a>
    </div>
    <div class="footer">
      <strong>للدعم الفوري:</strong> واتساب 0562150193 | البريد: ahmed@azad-systems.com | رام الله 🇵🇸
    </div>
  </main>
</div>
</body>
</html>
