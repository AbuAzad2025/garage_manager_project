# โ๏ธ ููุงุนุฏ ุงููุญุงุณุจุฉ ุงูุฃุณุงุณูุฉ - ูุฌุจ ูุฑุงุกุชูุง ูุจู ุฃู ุชุนุฏูู

## ๐จ **ูุงุนุฏุฉ ุฐูุจูุฉ ุตุงุฑูุฉ: ุงูุฑุฃ ูุฐุง ุงูููู ูุจู ูู ุชุนุฏูู ูู ุฃู ููุฏ ูุชุนูู ุจุงูุฑุตูุฏ ุฃู ูุดู ุงูุญุณุงุจ**

### โ๏ธ **ูุฐุง ููู ุณูุงุณุฉ ุตุงุฑูุฉ - ูุฌุจ ูุฑุงุกุชู ุฏุงุฆูุงู ุนูุฏ ูู ุชุนุฏูู!**

---

## ๐ **ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ:**

### **1. ุงูุงูุชุฒุงูุงุช = ูุฏูู (Debit)**
- **ุงูุงูุชุฒุงูุงุช ุนูู ุงูุนููู/ุงูุดุฑูู/ุงูููุฑุฏ** (ุนููู) = **ูุฏูู (debit)**
- ุฃูุซูุฉ: ุงููุจูุนุงุชุ ุงูููุงุชูุฑุ ุงูุฎุฏูุงุชุ ุงูุญุฌูุฒุงุชุ ุงููุตุฑููุงุช

### **2. ุงูุญููู = ุฏุงุฆู (Credit)**
- **ุงูุญููู ููุนููู/ุงูุดุฑูู/ุงูููุฑุฏ** (ูู) = **ุฏุงุฆู (credit)**
- ุฃูุซูุฉ: ุงูุฏูุนุงุช ุงููุงุฑุฏุฉุ ุงููุฑุชุฌุนุงุชุ ุงูุนุฑุงุจููุ ุชูุฑูุฏ ุงูุฎุฏูุงุช

### **3. ุงูุฑุตูุฏ ุงูุชุฑุงููู**
- **ุงูุฑุตูุฏ ุงูุชุฑุงููู = ุฏุงุฆู - ูุฏูู (ูุง ูู - ูุง ุนููู)**
- ูู ุงูููุฏ: `running = running + credit - debit`
- **โ๏ธ ููู:** credit (ุฏุงุฆู = ูุง ูู) ูุฒูุฏ ุงูุฑุตูุฏุ debit (ูุฏูู = ูุง ุนููู) ูููู ุงูุฑุตูุฏ

### **4. ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู**
- **ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู ุงูุณุงูุจ** (ุนููู) = **ุงูุชุฒุงู ุนููู** = **ูุฏูู (debit)**
- **ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู ุงูููุฌุจ** (ูู) = **ุญู ูู** = **ุฏุงุฆู (credit)**

---

## ๐ฐ **ุชูุงุตูู ูู ููุน ูู ุงููููุฏ:**

### **1. ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู (OPENING_BALANCE)**
```python
"debit": abs(opening_balance) if opening_balance < 0 else D(0)  # ุงูุณุงูุจ (ุนููู) = ูุฏูู
"credit": abs(opening_balance) if opening_balance > 0 else D(0)  # ุงูููุฌุจ (ูู) = ุฏุงุฆู
```
**ุงูููุทู:**
- ุฅุฐุง ูุงู `opening_balance < 0` (ุนููู ุฐูุฉ) โ **ูุฏูู (debit)**
- ุฅุฐุง ูุงู `opening_balance > 0` (ูู ุฑุตูุฏ) โ **ุฏุงุฆู (credit)**

---

### **2. ุงููุจูุนุงุช (SALE)**
```python
"debit": D(s.total_amount or 0)  # ุงูุจูุน = ุนููู (ูุฏูู)
"credit": D(0)
```
**ุงูููุทู:** ุงูุจูุน ููุนููู = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุฏูุน) โ **ูุฏูู (debit)**

---

### **3. ุงูููุงุชูุฑ (INVOICE)**
```python
"debit": D(inv.total_amount or 0)  # ุงููุงุชูุฑุฉ = ุนููู (ูุฏูู)
"credit": D(0)
```
**ุงูููุทู:** ุงููุงุชูุฑุฉ ููุนููู = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุฏูุน) โ **ูุฏูู (debit)**

---

### **4. ุงูุฎุฏูุงุช (SERVICE)**
```python
"debit": D(service_grand_total(srv))  # ุงูุฎุฏูุฉ = ุนููู (ูุฏูู)
"credit": D(0)
```
**ุงูููุทู:** ุงูุฎุฏูุฉ ููุนููู = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุฏูุน) โ **ูุฏูู (debit)**

---

### **5. ุงูุญุฌูุฒุงุช (PREORDER)**
```python
"debit": total_amount  # ุงูุญุฌุฒ = ุนููู (ูุฏูู)
"credit": D(0)
```
**ุงูููุทู:** ุงูุญุฌุฒ ููุนููู = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุฏูุน ุงููุจูุบ ุงููุงูู) โ **ูุฏูู (debit)**

---

### **6. ุงูุนุฑุงุจูู (PREPAID)**
```python
"debit": D(0)
"credit": prepaid_amount  # ุงูุนุฑุจูู = ูู (ุฏุงุฆู) = ุชูููู ูุง ุนููู
```
**ุงูููุทู:** ุงูุนุฑุจูู ุงููุฏููุน = **ุญู ูู** (ุฏูุน ูุณุจู ูููู ูุง ุนููู) โ **ุฏุงุฆู (credit)**

---

### **7. ุงููุฑุชุฌุนุงุช (SALE_RETURN)**
```python
"debit": D(0)
"credit": D(ret.total_amount or 0)  # ุงููุฑุชุฌุน = ูู (ุฏุงุฆู)
```
**ุงูููุทู:** ูุฑุชุฌุน ุงูุจูุน = **ุญู ูู** (ูุนูุฏ ูู ุงููุจูุบ) โ **ุฏุงุฆู (credit)**

---

### **8. ุงูุฏูุนุงุช (PAYMENT)**

#### **8.1 ุงูุฏูุนุฉ ุงููุงุฑุฏุฉ (IN)**
```python
if is_in:
    debit_val = D(0)
    credit_val = amount  # ุงูุฏูุนุฉ ุงููุงุฑุฏุฉ (IN) = ูู (ุญู ูู) = ุฏุงุฆู
```
**ุงูููุทู:** ุงูุนููู ุฏูุน ููุง = **ุญู ูู** (ุชูููู ูุง ุนููู) โ **ุฏุงุฆู (credit)**

#### **8.2 ุงูุฏูุนุฉ ุงูุตุงุฏุฑุฉ (OUT)**
```python
if is_out:
    debit_val = amount  # ุงูุฏูุนุฉ ุงูุตุงุฏุฑุฉ (OUT) = ุนููู (ุงูุชุฒุงู ุนููู) = ูุฏูู
    credit_val = D(0)
```
**ุงูููุทู:** ุฏูุนูุง ููุนููู = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุนูุฏ ุงููุจูุบ) โ **ูุฏูู (debit)**

---

### **9. ุงููุตุฑููุงุช (EXPENSE)**

#### **9.1 ุงููุตุฑูู ุงูุนุงุฏู**
```python
"debit": amt  # ุงููุตุฑูู = ุนููู (ูุฏูู)
"credit": D(0)
```
**ุงูููุทู:** ุงููุตุฑูู ุนูู ุงูุนููู = **ุงูุชุฒุงู ุนููู** โ **ูุฏูู (debit)**

#### **9.2 ุชูุฑูุฏ ุฎุฏูุงุช (SERVICE_EXPENSE)**
```python
"debit": D(0)
"credit": amt  # ุชูุฑูุฏ ุฎุฏูุงุช = ูู (ุฏุงุฆู)
```
**ุงูููุทู:** ุชูุฑูุฏ ุฎุฏูุงุช ููุนููู = **ุญู ูู** โ **ุฏุงุฆู (credit)**

---

### **10. ุงูุดููุงุช ุงููุฑุชุฌุฉ (CHECK_RETURNED)**
```python
returned_debit = check_amt  # ุงูุดูู ุงููุฑุชุฌุน = ุนููู (ูุฏูู)
returned_credit = D(0)
```
**ุงูููุทู:** ุงูุดูู ุงููุฑุชุฌุน = **ุงูุชุฒุงู ุนููู** (ูุฌุจ ุฃู ูุนูุฏ ุงููุจูุบ ุฃู ูุฏูุน ุจุทุฑููุฉ ุฃุฎุฑู) โ **ูุฏูู (debit)**

---

## ๐ **ุงููุนุงุฏูุงุช:**

### **ูู ูุดู ุงูุญุณุงุจ:**
```python
running = D(0)  # ูุจุฏุฃ ูู ุงูุตูุฑ
running = running + credit - debit  # ููู ููุฏ (ุจูุง ูู ุฐูู ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู)
# ุงูุฑุตูุฏ ุงูุชุฑุงููู = ุฏุงุฆู - ูุฏูู (ูุง ูู - ูุง ุนููู)
# credit (ุฏุงุฆู = ูุง ูู) ูุฒูุฏ ุงูุฑุตูุฏ
# debit (ูุฏูู = ูุง ุนููู) ูููู ุงูุฑุตูุฏ
```

### **ูู current_balance:**
```python
current_balance = opening_balance + customer_rights - customer_obligations
# ุงูุฑุตูุฏ = ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู + ุงูุญููู - ุงูุงูุชุฒุงูุงุช
```

**โ๏ธ ููุงุญุธุฉ ูููุฉ:** 
- ูู ูุดู ุงูุญุณุงุจ: `running = running + credit - debit`
- ูุฐุง ูุนูู: **credit (ุฏุงุฆู = ูุง ูู) ูุฒูุฏ ุงูุฑุตูุฏ**
- **debit (ูุฏูู = ูุง ุนููู) ูููู ุงูุฑุตูุฏ**
- ุงูุฑุตูุฏ ุงูุชุฑุงููู = **ุฏุงุฆู (credit) - ูุฏูู (debit) = ูุง ูู - ูุง ุนููู**

**โ๏ธ ุชุญุฐูุฑ:** ูุง ุชุฎูุท! ุงููุนุงุฏูุฉ ูู `credit - debit` ูููุณ `debit - credit`

---

## โ **ุงููููุงุช ุงูุชู ูุฌุจ ูุฑุงุฌุนุชูุง:**

### **ููุนููุงุก:**
- `routes/customers.py` - ูุดู ุงูุญุณุงุจ
- `utils/customer_balance_updater.py` - ุญุณุงุจ ุงูุฑุตูุฏ ุงูุญุงูู
- `utils/balance_calculator.py` - ุญุณุงุจ ููููุงุช ุงูุฑุตูุฏ

### **ููููุฑุฏูู:**
- `routes/vendors.py` - ูุดู ุงูุญุณุงุจ
- `utils/supplier_balance_updater.py` - ุญุณุงุจ ุงูุฑุตูุฏ ุงูุญุงูู

### **ููุดุฑูุงุก:**
- `routes/vendors.py` - ูุดู ุงูุญุณุงุจ (partners_statement)
- `utils/partner_balance_updater.py` - ุญุณุงุจ ุงูุฑุตูุฏ ุงูุญุงูู

---

## โ๏ธ **ุชุญุฐูุฑุงุช ูููุฉ:**

1. **ูุง ุชุฎูุท ุจูู ุงูุงูุชุฒุงูุงุช ูุงูุญููู**
2. **ุงูุฏูุนุฉ ุงูุตุงุฏุฑุฉ (OUT) = ุงูุชุฒุงู ุนููู = ูุฏูู** (ููุณ ุฏุงุฆู!)
3. **ุงูุฏูุนุฉ ุงููุงุฑุฏุฉ (IN) = ุญู ูู = ุฏุงุฆู** (ููุณ ูุฏูู!)
4. **ุงูุฑุตูุฏ ุงูุชุฑุงููู = ุฏุงุฆู - ูุฏูู (ูุง ูู - ูุง ุนููู)** (ูููุณ ุงูุนูุณ!)
5. **ุงูุฑุฃ ูุฐุง ุงูููู ูุจู ูู ุชุนุฏูู!**

---

## ๐ **ููุงุญุธุงุช:**
- ูุฐู ุงูููุงุนุฏ ุชูุทุจู ุนูู **ุงูุนููุงุก** ู **ุงูููุฑุฏูู** ู **ุงูุดุฑูุงุก**
- ุงูุฑุตูุฏ ุงูุชุฑุงููู ูู ูุดู ุงูุญุณุงุจ **ูุฌุจ ุฃู ูุณุงูู** ุงูุฑุตูุฏ ุงูุญุงูู (`current_balance`)
- ุฅุฐุง ูุงู ููุงู ุงุฎุชูุงูุ ููุฐุง ูุนูู ูุฌูุฏ ุฎุทุฃ ูู ุชุทุจูู ุงูููุงุนุฏ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-XX  
**ุงููุคูู:** ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑุขุจ

